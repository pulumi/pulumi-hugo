---
preview_image:
hero:
  image: /icons/containers.svg
  title: "Fullstack Pulumi: Deploying the MERN Stack on DigitalOcean"
title: "Fullstack Pulumi: Deploying the MERN Stack on..."
meta_desc: |
    This was a LiveStream with Matty Stratton and Christian Nunciato on how to deploy the MERN Stack on Digital Ocean (you can get the code at https://...
url_slug: fullstack-pulumi-deploying-mern-stack-digitalocean
featured: false
pre_recorded: true
pulumi_tv: false
unlisted: false
gated: false
type: webinars
external: false
no_getting_started: true
block_external_search_index: false
main:
  title: "Fullstack Pulumi: Deploying the MERN Stack on DigitalOcean"
  description: |
    This was a LiveStream with Matty Stratton and Christian Nunciato on how to deploy the MERN Stack on Digital Ocean (you can get the code at https://www.pulumi.com/blog/fullstack-pulumi-mern-stack-digitalocean/).  MERN-stack apps are three-tier web apps built with MongoDB, Express, React, and Node.js. You can read all about them in the MongoDB docs, but the gist is that they allow you to use one language—JavaScript (or TypeScript, if you like)  So let’s build ourselves a MERN app and deploy it on DigitalOcean with Pulumi.
  sortable_date: 2022-04-01T08:03:23Z
  youtube_url: https://www.youtube.com/embed/GNVoGC2IU0w
transcript: |
    Uh you know, I had a thought. Uh one of the fun things is because like, there's always a little bit of vibing before because it takes a minute for once to go live. Oh, wow. People are running already. Holy crap. Hi. Ok. Well, I take back what I just was saying, which is we have to kill some time, but I should create like a little intro thing that we can run at the beginning of it. But um yeah, so awesome. It's time for yet another Pulumi vision. We've been doing a lot of Pulumi vision this week, but lots of different things, trying lots of different stuff. Uh I'm joined today by uh my colleague and teammate and longtime Pal Christian who wrote a super awesome blog post about deploy the me stack using Pulumi. Um And I only now have, know what the stack is and I, I think I know it. I wanna see if I can guess if I can remember. So it's bongo. Yes. Something else. A Latin so elastic, right? Is it? No. What's the E stand for uh Express? Oh Express. That's it. And then react and no. Right. Yeah. Yeah. OK. Got it. So cool. Yeah, it's, um, so what, what, what I wanted to do, this was, this was a really, uh well received blog post, good job Christian. Like I love it. So we're gonna see if I can mess it up. There. Are, there are a few places but this was actually pretty, this one should be pretty, pretty, pretty straightforward, I think. But yeah, there's always a possibility. Right. Right. Right. Um So what's, what's, what's kind of cool is, I think, I thought we kind of go through this and then, and if, if we're thinking about. So, so we kind of, so I'm, so I'm going through it and by the way, I'll, I'll pop in the, if you're looking for it, this is the, that link will take you to um to the blog post that we're working through there. OK? Uh For those of you who, and I'll, I'll give you even a little, oh, there it is direct link. Yeah. Yeah. Um If you want a clicky, clicky on that and there's a lot more than just sort of the, the, the, the tech piece of this that we're gonna do. But um so a couple of things, so, and actually we'll kind of take a look first if we look at the blog post. So OK, so just sort of looking. So this is the burn, right? So we have our mango node and express what is express, I'm not, I am not uh uh like javascript developer and, and short of now that said I've been writing javascript since it existed. But that was also one of the last times I wrote javascript is when it started to exist. So, yeah. Well, Express is just like, it's a, it's a web framework. It's, it's basically, uh it's, it's, I haven't used it a ton but it, it uh it's a very popular choice for uh setting up uh you know, rest API S um on no Js makes it really easy to set up, you know, routes and, and uh set up Hamlet for those routes, that sort of thing. It's, it's just AAA nice, lightweight fast um choice for, for setting up rest API S which is what we're using it for here. Cool, cool. So, yeah, so what we wanna do here is we built, we built this and by we, I mean, Christian um this, this uh this app and in this case, uh using this digital app platform. So this is uh OK. So it's like hero, everything. He's like Karo, right? It goes back to James Governor's Tweet about like all that, everything we create is just over and over again trying to recreate Roku. And there's a reason for that because Hiro was um great. So this, this is the, the theory of, of app platform on do is basically what? So just that we can like, we could just, well, we can in, let's just, let's just, I mean, the nice thing about. So I, this was my, actually the first time I used the app platform, I've used digital issue for other things before, you know, like setting up virtual machines and, and so on. Um And that's all been, you know, great. But I didn't, I didn't even realize this app platform existed. But what's really nice about this is that uh it gives you these high level abstractions to play with, like you can create an app and an app uh has a, a couple of pieces that you can configure, you can set up a um a front end as a static website which is like popular choice for, you know, delivering uh web websites today, static website, a bunch of html files, a service which is uh basically containerized web application and then a database. And I, and so if you want to kind of have a front end and a back end uh say rest API and a database, which is a very common thing to want to do when you're building web application, that is basic web application, digital lotion gives you those three things and you just sort of configure each of those three things and magically out pops A URL, they're all configured to talk to one another and, and it's just a really pleasant um experience if what you're trying to do is set up a uh like a app. Um you know, or a three tier web app um that is, you know, container friendly and so on. It's just super. Yeah. And I feel like is it similar to um like Azure container apps? May I, I maybe you don't know, I don't, I mean, I feel like I feel like everyone's trying to do something like this, right? Like because we want to be able to accelerate our ability to rapidly get, get something deployed. Um OK, so if you're uh now again, this is not a workshop. So I'm not gonna go so slow that if you're watching, you can catch up, I mean, you can try, but also you can go do this yourself but a couple of things. So first of all, very nicely, Kristen made this template rebo um It's pretty cool. So I'm gonna go ahead and uh get this to myself and we will just call this my, the fern. I don't know. I feel like I just need to have some kind of crazy name. All right, cool. Um Yeah, so this, this repo tell me about like, what's it, what's it? I just, this has nothing to do with what we're doing. But so what's a templated repo do? Is it just repo but it doesn't fork it. Uh Yeah, that's a good, I, I guess I don't know what is the difference between forking it and the template book? I, I guess template upstream, right? Yeah. Yeah, you don't get the upstream. Um uh be beyond that though. I don't, I don't know what I, how I would summarize the, the difference. Um Because you're still gonna be, yeah, I guess, yeah, there's no upstream and so you're not pulling pr I can't submit APR back to Yeah, there's no, there's no connection to your, but other than it tells me where it came from. So cool. OK. So we, we did that. That was, that was super duper exciting. Um I already have Pulumi and node installed uh Chris and I were talking before just for purposes of this. I'm I am already signed into Digital Ocean. I already have my personal access token. Um And actually if you want to see something cool because at least I think it's cool um because I have it as an environment variable and I'm gonna show you how I have that stored in my uh shell config and you're gonna think, wait, Maddie, you're gonna show me something secret but I'm not and here's why like check this out, right? So this also by the way for, for people that watch fluy vision know that it is not uncommon for me to accidentally um give away, you know, like, like I gave Allie Diamond, like basically let her pop a shell on my laptop last week on accident, but this is just a ok. This is unrelated to what we're trying to do, but you might find this cool that was awesome. But that, that was awesome by the way. So check this out, right? So you can do this thing where so my secret environment variables are actually stored in the Mac Os keychain. And so you see how this works here, that's export. So when the shell initializes, it slurps them in from the keychain and puts them in there. So that way I can totally check this, this config into my dot files, repo and everything like that. But the important thing to see is look there, we do have so the digital Ocean Coke and environment variable has been set. So we, we have that um And at some point anybody wants to know how this works. Um You can uh I think I've got, oh well, whatever. Um Basically this, this, that keychain environment variable shell script that's in my home directory is, is the thing that, that matters for that, but it's really helpful um because you do store a lot of, you know, sensitive stuff in there. Um So cool. Anyway, but that was neither here nor there other than to say like cool, we've got our do stuff set up. Yeah, that's the one token that you need to configure Pulumi to run with Digi Lotion, I think. Yeah. Yeah. Um OK. So if we look back at what else we did that and then it says, OK, we need to grant digital ocean access to that reo so we're gonna go to the apps page, which is this one here and we're gonna say create app. Yeah, we're just gonna basically kind of step through this a little bit to give um permissions um to Digital Ocean to or like receive calls from github for you. Let's just, yeah, find the one that you, what is it fern fern? There you go. Cool. And this will send you back, I think. And um ok, I think, yeah. So I think if you pick this then, um, it was just the first one was just now I get to use those permissions, right? So, like if you weren't using Pulumi, you would go through and you wanted to create an app, you would, you could through the digital Ocean. U I completely just go through these, these steps. I don't need to do this. Don't need to do this. No. Yeah, you put that first step in order to, yeah. Got it. Oh, that was just to do that. Ok. Cool. Uh And then also because I would love to develop this application locally and I don't have nearly enough stuff installed on my laptop. I did install uh well and configure, I don't know that I configured it. I installed it. We'll see what happens when we get. Yeah, that's a good point. I don't know if I configured it too much either. I think I just, yeah, I did a brew install and away we go. Right. Um So, ok. So uh we're gonna say OK, we've cloned our tempo. Oh I need to clone that down. I'm gonna go ahead and uh clone. I, I know you can't see it but I'm just, I'm talking uh was it my uh burn? So that's why you don't give things. Oh my God. Well, no. So what I'm laughing, I, I'm still even to this day um stuck on the GH command like, like, like you used to now, now, now it's like get this kind of alias through GH for me. So I still have the muscle memory of typing GH clone, what I want to just name it but it is, you know. So anyway, uh the Fern, OK. So I'm cloning that down. Um OK. Uh I am now gonna swap back over to my editor uh instead of just showing this, you can follow along if you want. But OK, so if we sort of take a look um this is our, I know this part is small here but there we can kind of see all the things that, that got created in there, right? So um so this front end folder, this is our the React application, right? This Yeah, yeah. It's just a little React app. It's like a grocery list or like a to do list basically. Um Yeah. So just a super simple React app. OK? And then yeah, and then I'm gonna go out on a limb and, and I guess that back end is the back end part of the correct. That's the, the express stuff. So in those like in routes dot TS and so on, you'll see like, you know, um crud routes and things for, for posting new to dos and marking them done and all of that if, if you want to look at that. Yeah. Yeah, let me. Uh ok, so, yeah. Ok. So that's our pretty straightforward backend app And then, OK. So it says that this supports uh there's, there's three properties which are environment variables. So we set the backend service port, the backend route prefix and the database URL. And I'm gonna go on and, and guess that we're gonna show off how we configure that with Pulumi. Yeah. Uh Yeah. So when you run this locally, of course, you just run, you know, run a, a make command or whatever N PM commander right locally. But yes, when you uh when we'll show how to configure that with, with Pulumi when we step through building the Pulumi program. So, all right. So it says, for example, you don't have to do this. But if you'd like to, here's how, so um we of course, would like to. So let's give it a chance. So it says we do our N PM install. Yeah, just right from and this will install like this will run the N PM install for the reactor. And then also for the um for the Express app. Got it. And then if we do an N PM start the same script starts. Did I, I look in the, which one is that, did I miss that somehow? Make sure I'm in the right place. Yeah, I'm in the root. Uh, that will be in the package. Jason. 00, is it N PM? Yep. That's type of, yeah, that should be N PM run. Yeah. Others. Oh, my goodness. There you go. Ok. Oh I don't, well, it doesn't have, oh, does vite have to be installed globally? I don't think so. Ok. Um Because this is now saying vite command not found um because that should be in the oh wait, where is, where is Vites in the back end? It's in the front end actually it's the front. Ok. So I just, right. So there's the package like, yeah, there's vite. So, so N PM install will recursively go through these or do I have to run it on if you go ahead and try running it in both? I thought I was trying to, trying to have it, have it installed both, but I may have goofed that up somehow. You didn't know that that by coming on the stream with me today that we were gonna, this is how it always works. Everything gets troubleshooting your uh Yeah. Ok. So now if we do NP I run out. Ok. So we're ok. So, ok, so we have, it said it's listening on So if we go to OK, local host 3000, I will switch over once I see that it worked. OK. So cool. So sorry that this is like how we have to do this because streaming art is streaming, er, it's not streaming, sorry, retread. OK. So we have our, so this is our app. Cool. The Pulumi. Try adding something. See if you're, if, if everything's wired up right there, add some diet Coke. Did you get, did you get any, er, uh, nothing in the console? Oh, connection refused. So Mango must not be running. Are you, is it, did you run like the, um, mango? I probably did do whatever I'm supposed to do after I install. Yeah, there's like a Mango command to start, I think, to set the serve. The brew probably doesn't. It's a brew command actually. That, uh, yeah, that's, I mean, yeah, I, ok, let's see. Um, that was the brew install. There you go. Uh, Bruce services. It, yeah. Yeah. Ok. So that's running. Where did our grocery list go? We'll go ahead and restart that cat. Ok. Let's try to add Diet Coke again. There we go. That works strangely enough. The database doesn't work if you don't start it, who knew. Um, and then back to, if we go back and take a look at and then I think this was also where you were saying if we had compass. Um, no, not beyond compare compass. Oh, my God, it would really come for some time. Yeah, this is the first time I'm opening compass. So, uh, bear with me for a second. Mac Os. Uh, ok. Hm. If this doesn't come up in just a minute. Well, this is good. This is good. I get a little, like little notes and, yeah, I was gonna say, yeah. All right. So then if we, ok. Yeah. No, I don't care about any of this. Go away. Yeah, I, I'm sure whatever. Um OK. So if we oops. All right. So what was this was on local host? Right? So it's just 1270901 27017, right? Uh Or wait, is there a connection straight? No, once. Yeah. Once that's a good question. I don't know what to uh to do what? Oh, here you go. Oh Mango DB. Yeah. Oh, that, yeah, it might be in your terminal. Is it, did you, is it, did you see it in your terminal? Was it like admitted when you started the service or anything? Oh, yeah. Label home brew M XL dot Not. No, just that successfully started Mango DB dash community. I'm just looking for the example it gives it says example Mango DB plus serve slash fill in connection fields individually there. That sounds better host name, local host server authentication. None. Yep there. That's OK. So now we'll watch this happen as I go to your grocery list. Yeah. Your grocery list, um, with your one diet Coke in it. Probably. There you go. Yeah, that looks good. Yeah. Data. Then if we add one we should see it's, oh, is there a refresh? Yeah. Oh, wait, no refresh. There it is. Ok, cool. So that, that it actually worked? Ok. So at least we know that we know that our application is all fully functional at this point. So that's good. Ok, so I'm gonna go back to uh to this as we sort of step through. Yeah. So, so, so the thing here is like this is the flow you normally have, you work on a web app, you make some changes, you save your changes. Now, what do I do if you were like in the Heroku world, right? You would be like get push master or whatever, you know what I mean? And I'm off and running but like it's not that easy to, to, to make that happen on a cloud, especially as a developer. If the cloud you're using is like an Aws or an Azure where there are lots of powerful pieces, but it's kind of complicated and hard to wire them together. Getting that workflow to work is kind of pretty painful. Um And a tough hill to climb if you're, especially if you're new to this stuff, but that's the workflow we want to accomplish. We wanna have that workflow where we iterate on the app, we push our changes to get rebo and things work. And so that's what we're working toward here is being able to push those changes back to your templated or cloned rebo and have them flow through the Digital Ocean and built and deployed by Digital Ocean automatically. And so what we're gonna do, OK, cool. So we're, we're, and what we're, we're doing here is just one of the things to think about because there's a couple of different patterns we can do with our infrastructure code that we do with Lulu, right? So as if you're, if you're new to this or wondering so one of the ways is your Infra Code can live as its own thing and sometimes you'll do that with things especially like shared infrastructure and stuff. But in this case, we're gonna have the Infra Code, our Pulumi program that, that configures the things and does the deployment. It's gonna live in the same repository, the same place as our app code. So we can all be together. So we have our own responsibility for doing our own thing. Um So first thing we're gonna do is we are going to uh and again, because it's gonna be, you know, it's not at the root of a repository. We're gonna create a new directory called Infra which, you know, go figure because that's where our Infra Code is gonna go. And now we're gonna go ahead and create ourselves a new Digital Ocean. Oops. Oh my God. There you go type script. So, um again, if, if you're, if you're watching this kind of new, so what's happening here is uh we're, we're generating our Pulumi, the scaffolding of our Pulumi program and we're giving it kind of a start. We're saying, OK, there's a couple of things we know, there's some components that will come with Digital Ocean. So we want that and the language we're gonna use this typescript, we could do this with Python, we could do this with go, we could do this with dot net languages. But in this today, I'm just feeling like we're gonna do some typescript because it feels pretty type scripting. Now that said fun fact, you might think, well, we're doing the stack which is all node. So we must write our Pulumi code with that untrue, right? So we could write it in this. Now, this again, theoretically if I'm putting my Infra code in the repo because I'm the developer of this application. Likely the language I know is the one of the application. So that's the sort of side of that. So cool. So we're gonna let this kind of chug away. Uh we're gonna call it. Um Well, I don't think I want to call it Infra because that's gonna, oh I just realized something funny. I think I never fixed. I don't think it'll matter but I just wanna fix this one. Oh I my, I my, I my, my, my service account, it shouldn't matter. Um, I'm just gonna have to remember if we want to go show Pulumi in the Web Council who I am. It's totally fine. So, actually it's even less of a problem because it's an account that I blow away all the time so we could call it Infra. But I would, what would you think? I don't know that I would just want it because it'll, it, it's, it's really, like I think I told I called a grocery list when I was doing this myself. Is, is a or the Yeah. Yeah. Whatever. Yeah, because, because what is gonna happen is it's gonna be inside of my whole Pulumi world and in doesn't really tell me very much about it. Um That's the first time ever in doing a demo that I've actually typed anything other than the default for that. And we'll go ahead and create our, our DEV stack and which is the default. And uh again, a stack is kind of an uh an instance of your, you can think about it oftentimes relates to an environment doesn't have to, but we'll, we'll kind of think about it that way. OK. So we've got our um the uh we've got our new Pulumi stack was created great. And even if we sort of poke around and we take a look inside our, our Infra directory there, it is, we can see it created all these files, you know, which is you know, not nothing that's super exciting yet, but we can see the package Jason already took the, the, the packages we're gonna need, but we have to do a little bit of configuration. So one of the things is, you know, if we'd had that access token, you need to put it in as an environment very well, we have already done that. Um And no, I'm not gonna echo that environment variable to prove it to you because for all of my security things that would actually show it to you and I, you know, try to only do one massive security leak on the live stream per month. Um So tune in, tune in after tomorrow. Uh So the other thing is we need to tell, do just like we said. So, so this is now the beginnings of what we would have walked through in that wizard, right? Where we tell it what repository and stuff. So um and, and uh we could write this into our program, we could just hard code it, but hard coding is bad. So we can set configuration and also maybe on the stack, it's different for some reason or actually mobile, the branch might be different, right? Like so anyway, so I'm gonna run Pulumi config. Um And then we're gonna say set and then the repo we're gonna set to Matt Stratton slash Myrne, the fern, right? Your colon. OK. Uh I don't know if that colon got in the way there. Uh uh Let's take a look. Yeah, but we can fix that. That's what happened. He had created this Dev dot E. So I could also have done it this way. Like I could run that command or even if we want to be fun just to prove our point, we could say branch and nope, nope, sorry, I did that totally wrong, didn't I? There, there you go. That's ok too. Yeah. There you go. I was gonna be all fancy and the branch is, it was cool. That was great. Yeah. Um OK. So that, that did the same thing as running the command. There's two different, right? So one thing to go here that's a little bit different than we normally do things in Pulumi. So oftentimes when we're, when, when you're like, you're building an app, say that you want to run on some container service in Aws or something like that? Oh, is this gonna matter? I just realized I screwed this up. I can just drag my and fr to there. Yeah. What happened? There you go. Uh I created it at the, in, in the wrong place. Oh, ok. Now it's, now it's, it should just be alongside um app and no, it should be. And then that's what I, I think we're fine now. Just go, go ahead and you, you, you talk while I was gonna say is like when we're oftentimes when you're building like a web app and you want to run it in a cloud um like it's a node app or something like that or, you know, express app, you, you'll wanna, you'll need to part of the process of like writing the Pulumi program and then deploying your for your app into the cloud is like uh involves packaging the application in some way. So you run like a build step and you put that into a Docker image or something like that. And then you have to say where to deploy that Docker image. In other words, you're taking like the process of deploying uh with Pulumi involves building the app, packaging the app and then telling Pulumi like where you want to put the container images for that app or something, this is a little bit different. And and in this case, we're, we're using Pulumi to describe uh the application configuration we want Digital Ocean to use and Digital Ocean is gonna go and fetch our source code from github, which is why you set the rebo and the um branch the way that you did and build those things and deploy them for us. So there, so we're not actually like building any containers, you know, defining any containers or container repositories with the Pulumi program here. Instead, we're digital lotion will handle that for us. We're just telling digital otion where to go and find our source code. So this somehow I did a thing that basic oh OK. You know what I need to do? I jacked this up real bad. Bear with me for a second because when I did that it had to update the imports, which means visual Studio popped everything in node modules and wanted to change it. So I'm almost better off for this point for just, just wipe it and just the info one. Yeah, I'll, I'll, I'll, we'll, we'll be good. OK? But that's fine. We already had a because what, what I had done is I had, yeah, because in the interest of making the stream easier to deal with, you know, I had everything in a, in a more root directory. Um Oh my God, it's still. Ok. So let's see. So let's say I'm gonna say close all. Ok. And then we're gonna delete this. That's totally fine. Ok. Um I'll do this. So uh again this is how we know we're doing it live. So, yeah, this is how things get to be fun. Um ok, so we are in see the Infra gloomy new digital Oan typescript. Yep. Give it I'll give it a different name this time because in cool. Yeah, and then just run your two config again at your and those this time and that should give us what we want. Well, it, that's fine. Awesome. And um and uh I'm regretting naming them. Ok, cool. Um oh wait, let me do one thing to make this easier for everybody to see Ok. So we now we can actually maybe write some Pulumi programs. Cool. So we've got our index dot TS, which is our entry point because we're using typescript. If we're writing this program in Python, it'd be our main dot pi. It might be our main dot go if it's going, etcetera, etcetera. Um And a couple of things. So if we kind of take a look, right, we, so this is what our, what our uh our scaffold gave us, our template gave us is it's the packages that we know we're gonna need, we need the Pulumi package uh because we're already Pulumi and because we said this is Digital Ocean, it's already handled the N PM package, um the node package for Digital Ocean. And then it just sort of gives us like some boilerplates to start with, which I'm pretty sure we don't want any of this. Just start, it's all. So, um so the first thing is, remember, we said that we had um we want to access our configuration, you know. So uh we're gonna first pull in the configure object, right? So this is a new Pulumi. Uh This is what's gonna let us uh actually access those config things and we're also gonna set the repo and we're gonna say config that require and by saying require, it means that if we did not set this and we tried to run the Pulumi program, it would fail. It would be like no, go to hell. Now you may have config that may not be required because maybe they're optional and things. So it's not always gonna be a config require or you may have a default or something. This is a great example of something that would never have a default because what would it be somewhere? Yeah. Yeah. So then we do config that require um I know what's going on there. I, I'm gonna fix my squiggly in a second. So one of the things I think is cool. Again, if Pulumi, if you're new to Pulumi, I'm getting all this great pipe head and stuff and it's not because I have like some Pulumi visual studio code extension installed. This is just all, all those things are coming from either having, you know, if it's that for in this case, all of this information comes from the fact that we have the Pulumi uh package. And then this is because we have, well, actually that's all we have. We haven't done anything with Digital Otion yet. Um And then we want to say the region. So now we'll do some Digital Ocean. So this will be Digital Ocean. Yeah. And then again, see I've got all these things, these are all of the different, you know, methods right off of um not methods. Um but the parameters, right? And then SFO three. Yeah, we're just gonna be deploying everything into the same region here. OK? And then we want to go ahead and set up our uh manage Mango, right? And one note is totally fine because I don't want to spend all of uh Joe Duff's money. Uh So, yeah, yeah. And one thing to note about this, that there are when you're working in that platform, there are, there's the concept of DEV databases which are just a lighter weight, less expensive instances of databases that are not intended for production use, but just quicker to spin up and cheaper to use. Um But Mongo does not, they don't have a Mongo DB DEV database option. So you have to make it a DB cluster. Um Yeah, if you want to use Mango, so we have a database cluster kind of annoying that Digital Ocean's nickname is a reserved word in every programming language because it would have been nice to not have to type Digital Ocean over and over again, but you can't do two, you can't do do because um so OK, so we say the engine is let go. Don't worry, this is not a typing class. So pretty soon I'm gonna just start doing some copying of that we already wrote, but I just wanted to kind of show a few of the things that we get, you know, because of the version. Now, a couple of things that might be interesting. Um Again, all of this is we're sort of hard coding it, but this is all stuff that like, yeah, um we might want to if the interest of like there are different stack environments, like you said, like with this, you know, the um the node count like in DEV, you know, we might really only need, need one or, or the size, right? The same thing too. So this, we're gonna do the, the, you know, one VCPU we're gonna do node count of one. But in P prod, for example, we might need more. So instead of and engineer engine. So for example, just like we set this config we might uh make that something that changes from environment to environment um rather than sort of hard coding that that into there. And then we'll go ahead and create um our cluster. Now, this is what's kind of cool. So the id where, because it's a program we can pass that from this uh of this object that we created over here, we can pull the id from that. So we Yeah. Right. Yeah. Yeah. This is the database inside the cluster that, that we looked at when we, when we saw and what was it? What was the app you used for the, the database client? Uh compass. Yeah. Yeah. With our grocery list um database. Yes, that's what we're doing here with this next call. So we've got that database created and then um this is something I'm just gonna in the interest of y'all not having to watch me type because there's an awful lot of code here, but then we'll sort of step through what it's doing. So this blog post. Um But, but yeah, let's sort of take a look. So we, we're gonna say now this is the spec of, of app platform, an app is like a, an app is, is defined with a spec like this and it has different high level things that you can define. There's the static site one there that you see on line 31. Uh And then the ways so we're going to define like the get rebo and, and um and these are all variables that same thing in the region. So we don't have to keep specifying these things. Yeah. So we, we, we can, we, so with the, with the static site there, we've got to build step. So we tell Digital Ocean how we want to build that react front end, run this command to do it from this directory of source code. So that's the first thing that we're defining that static site and that static that will be defined in like a er it be deployed to like a uh to digital OTION CD N. So it'll kind of end up as a static um in, in blob storage and then they'll, they'll wire it up to the CD N just for you automatically. So that's the first bit. And then yeah, on 46 there starts the services collection, you have one or more services that we're going to run in this case, we're just gonna run the, the Express app that we looked at, um, a bit ago. And so similarly, we tell it and knows where to pull it from and all of that. So deploy on push. Ok. So, so you get that. Yeah. Yeah. So it's saying it's, uh, it's basically watching the repo when it sees a new commit to that branch, you know, it's watching and it's basically like a hook except not exactly. Exactly. Yeah. So, um and then, so this is OK. So it says when we connect to the Mango DB, right? The service needs the database URL which is conveniently exposed as an environment variable. Um So how are we getting this for, for? 00 Because it, it, because that's the spec is, oh, we're, we're setting it here. Yes, we're, we're providing in the, in the service spec we're, we're basically defining the environment variables that we want to be exposed to the service when it starts up. And we know we're gonna need a bunch of those. We're gonna need, need to know where the database is and uh you know what, what C A cert to use to connect securely to that database and all those things are gonna be exposed to us. And oh, because we created this is that object we created. That's the database. Yes. Yeah. Well, so down below there, um we, we define online 91. We define, we tell Digital Ocean, the the token or the the key we want to use to refer to the database that DB is, what kind of um is the token that all of the those values get hung off of? So by defining, yeah, I got confused because we also when we created the actual database and the cluster, that object's name is DB. So I thought we were referencing that but we're not because you're because it's inside of the spec, right? Yeah, those are those values um in that, that this is not javascript that's happening, right? That's, that's, this is the Exactly. Yeah, those expressions will be evaluated when the service starts up. Digi O and magic. Yeah. There you go. OK. That makes sense. Um Yeah, blah, blah, blah. So then we've got all of that stuff and then, and then I guess it says now uh so the digital Ocean it takes that. Um So that the last, so OK, we this last bit that we or I guess, well, I don't know if it's the last bit but I think you, yeah, that, that spec is really that those, that big chunk of Jason that we just defined is really the meat of the program. That's kind of weird. What did I just oh the app. OK. And let me just, are you getting any squiggles or anything? Did I did? I just do this twice? 00 Yeah, I, I think I you may have pasted. 00, yeah. I got confused about what I was, um, where I was in the blog post. I just pasted the same thing in twice. This is what I wanted. OK. There's, we need to, um, make our Mango DB. Not open to the whole big bad internet, right? This is that last little bit. Yeah. So, if, if we didn't do this then we would be able to access the Mango DB database from anywhere. Um which is cool but like, yeah, not the best, probably less than less than ideal. Yeah. Oh And there's one last thing we're gonna do because I actually wanna know the website that I created. Um And so this again, it's like in the, you know, kind of a Pulumi perspective, we we're gonna export, you know, so there's imports and exports. So we can, we can export this export just to the console, but also maybe I have another application, another place uh that needs to pull this from. And so this is gonna take live URL which is the what DIO assigns for the app and it's going to um or rather, I'm sorry, it's gonna take the URL which is a and it's gonna shove that into a Pulumi output or export, you know, it's gonna export that as a as a stack output, right? Called live URL. Yeah, an output of the of the app will, will be a live role property. We're just pulling it out of that by de referencing. Yeah. So, so now we can actually run this. So if we go ahead and were to say Pulumi up. Yep, this is new. Now, stop trying to, oh my God. I need to stop messing with my. I just didn't tell this thing like someone just talk. 0000, we get a compiler. Maybe we missed something. Um Cannot red declare it a, a name repeated or something? Is that, is that second call still in there? That second? I thought I could fix that but we can figure out. Yeah, I think you, it's still in there as well. Like your second pasted app spec Oh Yeah. OK. So it just needs to go. Where does it? Where was the last thing we did? There's OK. This, yep. OK. I thought I undid it but I did not did it all right. Uh Oh I know at this all the time. Oh my God. I slow down. There you go. Beautiful. OK. OK. So now you should be good to go. Yeah. Let's see. But what's happening here again? It didn't actually do anything when you run Pulumi up first. It runs a preview that says if I, well, first thing it does is that we already saw is it tells you if there's something that it can't compile that it can't run. But it says now if I did run here's what would happen and, and it has to create everything because as my current state is nothing, right? I don't have any of this stuff going on. Um So it's saying if we're gonna do this, we're gonna create the stack called DEV, right? We're gonna create that database cluster. We're gonna create the app and all this stuff. And if I wanted to be like, if you know, I don't, I don't trust anything because I am an old school ops person. So I don't trust anything. At least of all the computers, I can say, what are you gonna actually do? And I this will give me all the details of all the very specific things that are gonna happen. Um And I think looking for an example of what I wanted to illustrate here with auto naming, there should be something in here here. It is OK, perfect. So remember we said that the name we called it cluster but then, but they're like, what's this, this wacky thing at the end here? And the reason is by default and this is gonna sound like something that you're not gonna like. But trust me, when I tell you you will is Pulumi does this uh whatever name you give it um Unless you override it, it will append in a, a random identifier base or a unique identifier of some kind. And the reason is to help you because these are cloud resources, right? You don't want to have a collision. Now there are times when you're not concerned about having a cold and you might not want to do that like a user ID or something like that. And it's always, it's, it's very easy and no problem to you just basically set the name parameter on the resource that you create. But other than that, yeah. So we'll go ahead, let's fire it up, then go ahead and run and I am also while we're doing that, going to um go into my labs account here. Yeah. Yeah. So this is thinking, I'm gonna, I'm gonna show you like this is taking a second. But remember we sort of talked about um Well, we, well, you and I very quickly alluded to that. Uh We can see this stuff in the uh Pulumi console. This is because I'm using the Pulumi State uh um to store my state. You don't have to, you can store your state, but you have to have somewhere because Pulumi is running to say like is my infrastructure in the state. I want it to be in. It means you have to manage that state. You can store that in lots of different ways we call them back ends. Um This case, I'm using the Pulumi Sas. So because I'm logged in here, we can see this project that was created. And if I kind of look at it, I can see, OK, we had the DEV stack and look, oh, there's that configuration that we set is available. If I and you can see that this, this first update, the thing that we were just seeing run in the console, we're actually seeing it, um, running here as well. Now nothing's really happened yet. Ok. Well, there's the preview. I could even go see that preview. Um, just, I mean, this looks like all that stuff. So this is pretty cool. Right. So especially if I'm working in a group and then later, like right now you're kind of like, well, nothing's really happened in here, but I can see all that, that um history later, but we'll let that, I feel like setting that creating that cluster, that Mango cluster looks like it takes, yeah, it takes a few minutes. Yeah. Um I know um before it takes maybe three or four minutes and then what will be interesting again? So we're starting to see there's not really, but we, we will eventually be able to see all the resources that the cloud resources and, and, and things that come in here and, and the graph view is especially cool except not right now because we have one resource which is just the stack and not connected to anything. Um Like that. Yeah. Yeah. I think when that's the Yeah, so the, the first push of this thing to create that cluster is it takes a few minutes. Um But uh but thereafter, um updating the spec goes super quick. Yeah. So, and if we, um, I'm looking how to poke around and, uh, I think I'm in the wrong place. Um, oh, it's entirely possible that this is not gonna work the way that I wanted it to. Yeah, because I just realized, I think the token I have points to our team account and I don't think I flipped myself over to the larger Pulumi team when I granted the access or that's just installing the app. That was not even, that wasn't giving a specific, that was just giving digital, that was installing the github app is all that really? Yeah. Ok. So there was nothing about Yeah. Ok. Oh, so, ok. Well, while we're, while we're taking a look, if you just, you know, again, I would like to say I am from Missouri show me. So I look at, I look at, look at the Yeah. Yeah. Yeah. So there it is, there's our database cluster that we started. Um, and, you know, it's provisioning and, you know, the mascots are talking to each other. Yeah. So this, you know, this, this, this, this, this, you know, looks like a little, little take a minute. Uh So we can Yeah. Yep. That's, uh, it all looks like it's doing the right stuff. It's just, yeah, once that, once that cluster is created, then it, then it goes quick. So, well, I don't think we need to um, sit and watch, um, paint dry when that, when that kind of goes along. But uh a couple of things as you're, you know, going through your, your journey with this also, um this is you should definitely, I highly recommend, you know, again, go go back, you know, read, read this whole blog post because there's a lot more into it than just the Pulumi code. Um Super interesting. Uh Absolutely check that out and, you know, with the latest updates that will be forthcoming that we, that we found out um like Chris will fix this now also. But if you're interested though, also in that blog post, so we were using typescript, but maybe you're a Python person. There's Python example code or not not. I wouldn't say I won't say example code, sorry, the, the code there is Python, the same stuff we did in typescript here is in Python as well on that blog post. So you can totally um go go with it. 000, something happened. Good thing, green, green, red thing. What color is the thing that happened? It's red. Oh, yeah. Yeah, you are not authentic. Yeah, it's, it's because of I'm, I'm pretty sure I know exactly why. So here I'll, I'll show you what I think I do. I have to um here I think I hit this myself when I was using the Pulumi Account for that. Yeah. So I bet it's this. So if I go to because see I hadn't been, I had been under uh MT like my team when I did that thing. So I think all we need to do is I go back and find that thing um where you had the link, the uh apps page. So here, see, now I'm in this Pulumi because my token is is to Pulumi. Yeah. So now if I say create, create apps, yeah, but I think you may actually need to like uninstall the github app from your personal org if that's where it was attached before because yeah, let's try it because I, I pretty sure I hit the same thing yesterday. It was momentarily configured. Oh, I see what you mean. It won't let me uninstalled Digital Ocean. Probably what I would probably do. Yeah, but it's only hitting me. It's not hitting like Pulumi thing. OK? Cool. So then if we go back to here, come on. Um OK. Choose a source, Richard walk you through lot. Yep. That makes, yeah, that makes sense that that's what happened. OK. That's should be fine. OK. So let's go. Now, the good thing is like you said we did, the hard part cluster is created. Yeah. So we, we cluster got created. It was just the app because that's the and I'm just gonna gonna get that all those. So I did what's happening? I installed this thing called Fag. That's like supposed to be this like really helpful, like auto completion thing, but it's getting way aggressive on Pulumi I've noticed. So Um Also, I don't know what I'm doing with it but there's that, you know, that's what happens when you install. So this is also why when you, you should not install anything that is not standard in the environment that you are demonstrating things to people. Um That's just uh cool. Let's see if that, I'm gonna take a look myself and see if that app is being provisioned here. Well, that's, that's a good point. We should be able to, it didn't, it didn't blow up yet. So that's a, that's a good sign. Well, it's the last. Yeah, so I see some stuff happening. It looks like it's in a pending phase and I don't think it, it never, it didn't even get this far because remember we only saw the gola one. So the fact that we saw anything uh is, is promising. So it says you created a new app called Grocery List. This is where the fun begins. Someone needs to talk to the folks in digital lotion about what fun is. I mean, as, as cloud consoles go though. It's pretty fun. It's pretty fun. Digital Ocean does have a pretty enjoy, you know, it's, it's uh yeah, what's cool about this though too is that once this deploys, you'll be able to like all the logs and everything flow right up into the deviation console? That's pretty nice too. So you can see if you get any runtime errors or, or issues there. And yeah, pretty nice. When I said it goes pretty fast after the cluster is created. I'm, I don't recall it taking this long. I think your CPU cycles may be starved a little bit. Um But, you know, on your laptop just because of videos and things, I often hit like slowdowns when I'm, whenever I'm trying to do anything on the command line, I'm also running a screen. It always sort of slows down. The world could be, could be. Um And we are probably doing or something that there's probably a build running like the, the containers or maybe building or something, I'm gonna, I'll look at the logs myself and see that. I think there's probably just some, some things happen, things are happening but uh looking at the Yeah. Yeah, watching in progress bars. That's what we do. Mhm We used to, you know how there's the XK CD that it's like, you know, the programming of what they do while the codes compli compiling. I remember we used to say that was, that was vagrant up, you know, because, because you were spinning up a V I, you know, I mean, like you would do it, it was great, but especially if you were doing like, again, this was back in early Chef days, right? You know, and if I was doing like, like trying to do like, uh you know, uh vagrant but like with windows, you know, so like every time you make it up and had to like provision a windows VM. So like that, that was a few minutes just to run a, run a kitchen test, you know. So. All right. Well, I think we proved our point. It's gonna be, it's gonna be great. It's gonna work. It's gonna be when this, so if we have, if we do have, if we run out of time when this finishes, you'll get a nice little URL that will pop out at the end. You browse that URL, you get your grocery list and everything works. It's, it's pretty cool. And then if you push a commit to the github repo, it'll all be rebuilt and flow out automatically. It's, it's quite a nice work flow actually. Awesome. Yeah. And then of course, uh what I'm gonna do as soon as this is done is actually, I'm going to run a Pulumi Destroy which will get rid of the club resources because again, we don't sit here and be like, why is this app service running in the background? Nobody knows about it. You know, they're like, hey, wait a minute, let's, let's what's, what's this deal bill going on here, Mandy. And I'll be like, it's Christie's fault. Totally cool. It's fine. That's exactly how we do it. So. Well, Chris, this is awesome. This was fun. Thank you for coming in streaming and everything and uh everybody who joined us and um make sure that if uh you know, whatever platform it is that you're watching us on, you know, match the subscribe or follow or like or whatever so that you can get notified about uh our upcoming streams and we, we do these every week. So thanks very much and uh.

---
