---
preview_image:
hero:
  image: /icons/containers.svg
  title: "From Code to Cloud: A Developer's Guide to Kubernetes with Pulumi and Scaleway"
title: "From Code to Cloud: A Developer's Guide to Kubernetes..."
meta_desc: |
    In a world where Developers must work in the Cloud, it has become mandatory to know cloud technologies. Join Diego Coy from Scaleway and Engin Diri...
url_slug: from-code-cloud-developers-guide-kubernetes-pulumi-scaleway
featured: false
pre_recorded: true
pulumi_tv: false
unlisted: false
gated: false
type: webinars
external: false
no_getting_started: true
block_external_search_index: false
main:
  title: "From Code to Cloud: A Developer's Guide to Kubernetes with Pulumi and Scaleway"
  description: |
    In a world where Developers must work in the Cloud, it has become mandatory to know cloud technologies. Join Diego Coy from Scaleway and Engin Diri from Pulumi in an exciting Live Stream on "From Code to Cloud: A Developer's Guide to Kubernetes with Pulumi and Scaleway."  Diego Coy, an expert from @Scaleway-cloud, is a developer transitioning to the cloud. He will share live his first-hand experience with Pulumi and insights while using it with Scaleway to deploy scalable and production-ready Kubernetes clusters. Engin will be the guide through the experience of leveraging Pulumi's Infrastructure as Code platform to simplify and streamline your Kubernetes deployments.  Whether you're a developer transitioning to the cloud or simply looking to enhance your Kubernetes expertise, this live stream is meant for you.  
  sortable_date: 2023-08-01T15:17:24Z
  youtube_url: https://www.youtube.com/embed/8XIQ-S-e5us
transcript: |
    So, hello everyone. Uh Welcome to our session for Pulumi and Scale and I have also a guest. I'm very excited since I probably weeks to welcome you Diego uh in our little web session. And yeah, let me pass to you and introduce yourself. Hi. Hi, thanks for having me. Yes, I'm Diego. I'm a developer advocate at Scale Scale Way is a cloud provider and located here in Europe uh with data centers in Paris and Amsterdam and Warsaw. Uh And yeah, I'm here uh wanting to learn in public with you. I'm a web developer. I've been doing web stuff for the last 10 years, but recently I made a big change jumping to the clouds and this is completely new to me. It's a new world, but I'm really excited to explore and learn more and approach things as a, a new person in this world. Yeah, that, that, that, that's perfect. So you are absolutely right here because uh with Pulumi and infrastructure is code, we have the developer in mind and you will see also when you start working on it, um how naturally and close it fields to your normal development work. So I'm interested to see your feedback after all. And uh yeah, that's the thing I see also that we have already some uh viewers inside the greeting us, but I don't know how I can display the, the message on the screen. So I say hi to everyone. New comments will be displayed here. Perfect. So um should we just start? So we don't lose any time and we can see um all about. But it would be interesting. First of all, if you can give us a little intro about scale way because I'm not sure if everybody knows about scale way and the services so feel free or. Sure. Yeah, I have a short presentation over here. Uh Let me share my screen now. Which screen switch? OK. I think this one. There we go. You tell me when it's live. Perfect. All right. Yeah, it's a presentation. So yeah, I told you is a cloud provider and we have all the basic services and more than that that you can think of. So for instance, if you want virtual machines, we have them, if you have um want functions, we have them databases. There we go. Uh Now of course, we have key uh we have uh instances on arm now. Er Well, we used, we used to have them. Now we have even more and we will be having some more instances on running with a video cards with GP US in the near future. So yeah, it's a whole solution for whatever you will need in the cloud. Uh feel free to pink me if you want to learn more. Uh but definitely check out Skway dot com. Perfect. Uh That's, that's, that's really nice. So yeah, um I use, I use Scale Way also privately. So that's very interesting. So when I heard about Scale Way a couple of years ago I had to try it out and I was really, really impressed um about uh the, the offering they had at this time. But now you already grow much, much more. So I sometimes say that for me is one of the feature complete uh providers here in Europe. And uh that's what I really like. So nice then. Yeah, let's uh jump into uh our session today. So I will also share at least on uh on the youtube chat. Um the link to the report. What are we doing? What's, what's my challenge today? Yeah. So I prepared a uh a workshop for you. So we're going to build in different steps. So we're going to create a Cuba cluster and we're going to use typescript just to show OK, the typescript capability of Pulumi using it, then we step forward and say, OK, let us create. Now also uh uh example service creating AAA container for it. We use the, the do a coupon needs uh the do a provider from Pulumi also in typescript. So everything is written down you can create your, your container, you can put your application logic into your your repository, for example. So that's one part, the next part will be then to say, OK, let us deploy using Pulumi onto the Cuba needs cluster. That's the next part. But again, this is a very simple example. So let us step in the in the in the next chapter, a little bit of difficulty and deploy flux. So we're going to create the Cuba needs cluster. We're going to use Pulumi to deploy the the flux onto the cluster and then point out directly to an uh repository in github where our application logic lies in and then we can continue from there, changing some values and flux should automatically deploy um the application and last but not least we also add some some chapped on it. Uh Everybody talks currently about internal developer platform. So I was like, OK, let us uh port to it port is a low code, no code platform. And we can easily create also via Pulumi every blueprint we need inside port to have at least the service catalog capability. So we should see our uh scale equipment cluster in port and also see as an inventor of everything which is deployed inside the cluster, also the hand releases. So that's going to be really, really funny. Um Yeah, that's the, how many hours do we have today for that? Yeah, it's uh it's a little bit challenging but I think we will manage this because most of the parts inside the example repository is everything prepared. So you don't need to write everything from scratch and we can just focus on some of the important parts. So yeah, feel free. Right. Yeah. So I was aware of the challenge. Yeah. So that was just like I did know, but I just set up some basic stuff here just to make sure that we didn't lose any time setting things up. So I'm gonna share my screen again. Uh This always takes time and get it. Am I sharing the right screen? No, you don't share. And these things happen live all the time now you're sharing. Uh And not. How about now? Yeah, there we go. So yeah, this is the report that engine was mentioning. Uh and uh kudos on the organization of the whole uh steps here. So now I know that I can go to step 0123 or 45. So that's really cool. Uh I already set up a Pulumi locally. No Js go the scale with Cli Docker was pri installed on the environment. Uh QC TL. I do have a Docker account. Uh hell and flux D were also installed. Uh So let's jump into uh the step zero. You may need to increase a little bit. Uh The That's true. So let's check the cluster set up steps. So over here, uh you were saying that we need to clone the Rio. Er and I did one important thing to note is that I'm using Depot to set uh the whole environment automatically, sorry automatically for me, which is really cool. You can install Depot and then you create a workspace. And over here you select which kind of uh where's the source where the repo you want to work on? And then you select a provider, you have a bunch of providers and if you want to use scale away, it just so happens that our man here was the creator of this scale provider. Uh Diego. You need to increase a little bit more the phone people. OK? For the maybe it's not possible but for this 100, they thought about this. Uh Perfect. OK. So yeah, so I was saying and in here is the author of the scale provider for that and that's how I created a workspace for my project today. Perfect. Got it. So yeah, er I cloned the Rio and then I uh started scale way uh cli I all the scale ci I added all my credentials. Uh And I'm ready to start working on the cluster. Well, to listen to clusters actually. So over here I have my visual studio code and yes, I'll zoom in in just a second. Uh do do do do appearance a full screen, not I believe I can use the shortcut. Yeah. Yeah, perfect. So yeah, this vs code is connected to that uh workspace that's actually running on a virtual machine in scaling. OK. So here we are uh let's clear things up over here. And you're telling me that I need to check the cluster list, right? So yeah, just to see that your cli is up and running. So we can see with CAL, OK. So you're communicating, it is able to communicate with scale. Yeah, with my credentials. So we're good to go. Then I need to run M PM install inside the uh steps zero of the uh the whole workshop which is cluster set up. And that's where I, where I am right now. So N PM install wins will install the dependencies that we have for this project, which are the types that have dependencies. And then Pulumi and your scale provider, right? Yeah. Can have a look into the index test just to show the, the the example project while it's uh installing what we created in the way. Let's have a look at that. So what I can see here is that we are uh importing uh Pulumi and scale away as dependencies. And then uh you're creating a cluster config which is a new Pulumi config. So I'm guessing that brings uh data from the Pulumi gamma file. Yes, that's, that's uh that's an important step. So the Pulumi config is we can create a project based config which is for all sticks available and then you can overwrite for your definite sta So in this case, you're like, OK, that's the perfect setup for a scale we cluster if you then create now a stack which is uh similar to a workspace or your environment. So most of the people use de pro uh staging um you can overwrite, you can say as you mentioned using a GP U powered node for your plot cluster. But for everything else you're like, OK, we don't need the biggest uh um notes for example. So and then we can read out this config files with the Pulumi config just get the key and Pulumi sort out in which stage you are so. Great. Great. So I would be able to change uh France, Paris to Netherlands Amsterdam, right? Yeah. Good. Well, let's leave it at uh Paris and let's continue. Then we have a capsule. So capsule is a one of the managed services for that scale we offers, right? And so we are creating a new cluster here uh where we define the version. Uh We are using uh as our network uh container network interface, right? Yeah, that was just an opinion from me when I created it. I mean, I think you still support also flannel or calico, I think then you can choose uh depending, but I think everybody should use cum by now. So that was just my, that's the reason it's not configurable. All right, then we set some tag uh for the cluster uh additional resources should be deleted. Yes, some auto upgrade uh settings, uh main windows and all that good. So we have the cluster, the cluster is defined there, then we uh have some node configuration. Uh So with this configuration, we are bringing all the information that's under the Pulumi file under note. So this is the definition of the notes that we will use so we can use small machines or big machines, right? Yeah, I separate it here. As you see, you can create and Pulumi different name spaces. So I created a name space just for the note con. That's the reason you see there with Pulumi dot config node and then one for the cluster. Again, this was some opinion of me, you could uh organize yourself differently. It's just to show um that uh the capability of using name spaces inside your config. All right, then we set all that up and then we associate it with the capsule uh that we created over here. So this will be part of that cluster. Uh Thanks to this uh definition. All right. And then we export that information over here to make it available. Yes. OK, good. Am I missing anything important? And no, not for now. I mean the export path you see down. It's important that you can then say for example, uh Pulumi stack output, you can get the information if you want to use them programmatically somewhere or as we see later. When we introduce the concept of stack references to reference from one Pulumi stick to another, the ideas behind this. Um There could be separation of concerns. We could have an infrastructure team which provides you the Cuba needs cluster, they own it, they take care of it and you as an application developer as you see in the next chapter will just reference on some of the properties, for example, the cube conflict because you want to deploy something and then uh yes, you're not in charge of it. You cannot accidentally delete the stuff or um maybe there's an internal process that you have to order it from somebody else but people can still use. And this is also the the multi language approach. They use the language that you confirm you as developer, we will see later can switch the language for your language of your choice. So that's interesting. But yeah, give it a N PM install because uh let's see how quick scale is with. Uh Yeah, we need to and then create a cluster M PM install has been run already. So we have the node modules folder there and then we need to run Pulumi up. So uh do do do do so. Yeah. And yeah, so I can run it locally or I can create an account, right? Yeah. So uh Pulumi is the open source software. We have a solution, a solution, a Pulumi cloud solution where you can store your um your your your states, it's also free. So you can choose. Now here in your case, do you want to use the cloud service or you want to store it everything locally? I always prefer um to let somebody else take care of my state not uh work around this. So maybe in this case, uh just use the cloud provider, it should be as easy as creating an account with github, right? And then I create a token. Um And there we go. Now you need to talk. Uh Yeah, it's fine. It's fine. People, people won't abuse it at all. No worries. Uh Do I just paste it here? Yep. Uh Maybe you have to move the, the your VS code a little bit to the left because our um little avatars blocking the view. So yeah, so perfect. OK. Now comes the thing we just mentioned before with the stacks. Now you can give um your stack a specific name. I always prefer to use some kind of stages in this case. So um yeah, so I create a new stack uh and I can use uh name space uh slash name workshop. Oh What do you recommend? Uh just uh for, in your case, for example, you don't have a name because you have a, a private, I mean you got the enterprise organization, you can just enter the stage here. So in this case, name it de that's fine. OK. So good. Now Pulumi gives you now with the, I mean, with the app, you have the preview functionality and the up functionality in one thing. So you get now the feedback which of stuff which is changing in your case, you didn't have anything installed. So Pulumi says, hey, it's a crate for every resource and you get some of the outputs. As you see, some of the outputs are not filled with a value because this depends when the cloud provider is running. So there is a separation. This is something we cannot determine during um the the heat during the previous time because it's values which gets generated from scale way. So in this case, you just see for q confiture, there will be a string but currently there's nothing inside. So that's the thing and if you are with um what you see um feel free to to up it and yes, I can't hear you. Do you know your voice is gone? Can you check your mic? No, I can't hear you. Can you hear me? Can you I think you are go Diego. OK. Diego Scott. So OK. Um then we just uh wait a little like here you go back again. We cannot hear you. Yeah, power, everything included uh using my phone but I'm back. Ok, perfect. Then where were we? Uh Yeah. Did you talk about this uh preview? Yeah, just uh yeah, the preview functionality. This is clear. The um the cloud provider gives you feedback. Uh Not everything is filled out in the moment and we just need to run now the app maybe you can share your screen and then we can see I'm not sharing my screen, right? Because everything restore it real convenient. Ok, perfect. So yeah, I hit uh yes, I confirmed and it started uh deploying everything. Perfect. And we have a question from secret agent man. 00 on youtube. Hey um Hey and die. I've been a web dev for years but never needed to work with infrastructure. Any advice for experienced des out there wanting to learn Infra would be appreciated. So, um that's a great question. That's kind of my situation, right? That's how I told you for. Uh I never found the need of working with infrastructure as a developer or working for companies because that was my job, right? Just working with the web and someone else who was handling the rest. But then I wanted to do more stuff for my own projects, my weekend projects and then my home lab and then uh if I wanted to work with clients on my free time, then I would need to have a proper uh uh not only the proper app but the proper environment where it was going to be deployed and handling that for many different clients then becomes a little cumbersome. Uh So yeah, then I found the need. I think that was the first step of finding the need because if you don't actually find a reason to learn these new technologies and you don't have a, some way somewhere to apply those new uh concepts, then it becomes like empty knowledge that you have in your brain. So my, my suggestion is try to find a project to work on and to start applying these uh new technologies that you will learn. Yeah, it's, it's similar to, to, to my experience to say, OK, sometimes um in the current set up in the company, maybe it's not possible or not. Uh not a scenario where we as developer have access to the infrastructure. So in a direct access, so most of our customers, for example, depends also on the size, either they created a journey on top of it so people can order the infrastructure and have then inside the ordered infrastructure in an account or in a subscription in the cloud provider, the possibility to then uh modify the infrastructure or they have dedicated uh people inside the team who takes care of this. It really depends the situation. I saw every variation from a learning point of view. I would uh as you said, also invest the time, understand um some of the basic concepts how to create or how to define the infrastructure as code. Um some specific uh resources, how to apply them and uh how to keep them update, that's something. Um And there are many, many resources out there. Um There are many tools out there. One of them Pulumi as we show now here. And yeah, that was my firewall. Ok. That's your firewall is peeping. Yep. Yep. But it's fine. It's fine. It's just rebooting. Ok. And yeah, for uh, deploy a firewall in your home, la create a home left. That was my first step towards cloud actually having a home lab that started with a pie hole. And then I quickly added a firewall to, to be in control of my network. And then I added uh A S uh to store my files and then I started adding uh virtual machines on top of a pro and that's how it started. I found the need. I found uh uh the need for it to start uh start using these new concepts instead of just uh using uh managed services which are cool, are great. But as a learning tool, I think it's a good approach to start deploying things yourself. Yeah, absolute. Absolute. And here we can see now, um cloud providers takes a little bit of time to get the things up and running. I mean, we know all that um um some are quicker, some are take even more time. So I did recently some EK deployments and EKS can also take up to 10 minutes to, to get an EKS cluster up and running. I found a scale way quite quick in comparison, I think this will take us now 500 seconds. Or something around this probably. Yeah. And uh yeah. Ok. The the the note count is free, maybe we could have also reduced it to one to, to get the note pull up and running quicker. But, ok, that's fine. There we go. Perfect. And now comes one thing with uh the the inbuilt secret managements of uh Pulumi. Pulumi supports uh secret management. You don't need to create an additional secret. So it's already inbuilt. If you want to move out of it, there's also a way to, to change the secrets back end. And here we can see the config is marked in the output as secret. So your state file doesn't contain any secrets. So you're not accidentally leaking some secrets. If we look into the index, ts if you open this, you will see the functionality behind this when we scroll completely down. Uh You will see here the Pulumi dot Secret. So you can mark the output with Pulumi dot Secret to uh to hide it in the output. And there's also an option in the resources. So for example, sometimes the resources also leak some of the the details as an output, even if you don't put it in an export statement still in the state file. Because some cloud provider think like, hey, I just put the the database password and the URL as a a clear text into the resource doesn't mean everybody does this. But sometimes it happens, you can even go to the resource and mark specific property fields as secret. So Pulumi is also obfuscating them and you not accidentally have um properties inside your state file with uh some secrets in it. So this is also a very cool concept of it. But yeah, uh congratulations. That's um already managed uh chapter one. So let us see in the read me, if we did not forget anything to check it, then we run uh Pulumi stack output to retrieve the value from the stack. Yeah. So that, that's the thing we can. Then as I said before, Pulumi stack output, we can get every we use here. In this case, we want to just save the cube config and try out if the cluster is really up and running. So you can just copy, paste the command. There should be the button right to it to just copy, paste it. Diego. Yeah. And um yeah. Yeah. So now you put on file. Yeah. And now you can uh run uh whatever examples, whatever examples. Yeah, just to see the notes and it should. Yeah. So we see all three notes are up and running. Uh The version is 1.27 that's also fine. And yeah, they are ready to go to continue. So we proved that everything is working out. It's working fine so you can move on and while you move on for the second chapter, we have also another comment coming from linkedin from Simon. Simon, I love the secret management. If it was one of the favorite things I discovered when I wrote a paper comparing Pulumi versus biceps versus terraform. So thanks for this. Uh If you want to share Simon your paper with us, uh feel free to, to reach out also in linkedin, for example, with the Pulumi account. And we are happy um to, to, to amplify your paper if it's possible to, to show it publicly. OK. Chapter two, chapter two. So we need node and which are installed. I am already installing the dependencies with N PM and then we need to pass the secret to Pulumi. Yeah, this maybe you know the answer for this one. When we look into the code, it looks like um that um you know, you need to, when you use uh Pulumi with, you need to be registered with the, with the registry. So uh what I did here, I created a registry name space on line 5 to 7, you know, just giving. Uh because now comes scale offers also a container registry which is very, very nice if you want to keep your containers close to the data center where your is running. But um as user name, it uses no login and the password is the secret key. So maybe I missed the situation just to create an IM or whatever dedicated I am for this project and use the, the the secret of the im um without passing, passing now your your your secret key. Um So sorry for this. Maybe Diego, I have an environment variable. So it may work. We'll see. But uh yeah, can we, should we go over the code? So yeah, you mentioned that we are creating a container registry. Uh And then we are creating a Docker image out of uh the app folder, right? This is amazing. It's amazing because you having to do this manually every single time which I have because I'm new. So I'm doing everything by hand while I learn. Yeah, it's awful. But then here everything is automated. It's great, especially this part creating the, the registry and then pushing an image to the registry. It takes a lot of copying and pasting uh I Ds and, and names faces and all that. So, yeah, I love this part. The, the idea was here to say, OK, maybe the DEV team is in, it are allowed to have several registries because it belongs to them. So that was my idea to give the registry not into the infrastructure stack but to the develop, I mean to the uh creation stack of your image um just um to say, yeah, could be that they are allowed to do this. Yeah. So I created a file where I store the names of the keys for the environment variables because I knew I would forget them. And if OK, then let us change the, the part, you know, then let us change one part in the code ad hoc and say uh uh um so when you go into line 21 we don't get. Now the, the secret from uh the, the Pulumi inbuilt secret, let us use uh the environmental variable and uh to access the environmental variable in a typescript or not, you have to say process dot N uh then, and then um the name to that to the uh yeah, calling of the TS file or will Pulumi be able to catch it from the general environment variables. It, it should catch now from the uh I mean, now it's the typescript who's collecting this and it should uh get this from. We will see when you do a um Pulumi up that. All right. Uh We inspected the code and now we be able to push the, push the image. So let's go Pulumi up and then we need to create a new stack, right? Yeah, because it's a new Pulumi project. So we create now every folder is our own stack on its own. So we can show here that we can run a micro stacks. We don't need to have any modest monolithic huge files, we can split everything. Um because we had that, that gives us the flexibility if the the dense is differently. So maybe the cluster doesn't change so much and we don't need to run every time and wait for the output of the cluster. So we name it the F 01. I would call it deaf because it's a different, I mean, you can keep them all same name because it's from a different um stack, the, the, the de stage for example. So it looks good and hopefully he wants to create a registry name space and then pushing an image to it. So yes, we want that and now we wait. So it's building the image, creating the name space and then pushing the image to that uh sorry, creating a registry and then pushing the image to that registry. Perfect. It's so cool. Is there anything planned on scale way side to support maybe in the future um or something to say? OK, I mean this example could also run on one of your container services. But is there anything planned to um to pass maybe just a git repository to your container registry? And it builds it automatically? To be honest, I'm not sure uh what's uh if it's part of the timeline, I would bet it has crossed their minds, the team's minds. But yeah, I wouldn't be sure. OK. Cool. Because I saw this possibility from AA AA does it in container registry? You can uh have container tasks and then they build this for you using uh for example. All right. Although we do have a feature request uh website that you can use to request whatever you think will be useful for you. And or you can also let me know and I'll pass that along. OK, perfect. So we have any more questions. Uh No, not now. Currently, I mean uh Simon just shared his link to his document. He created the comparison. I have to look it after the stream. Uh Thanks for this and uh he's building the image. Hopefully it will take some time. So while it works on that, uh what else can we see? We have a five, a, 1/5 step that's optional test the application. OK? We can run it and then make a cur request to make sure it works. OK? And then after that, we have some stretch goals that uh we may be able to come back to if we finish on time. Yeah, I that's uh there are some, I mean, everybody who looks up this later and repeat or already watching the, the the repository I created also some stretch code that you can change to from, to the one from chain guard. So you get um reduced attack surface. So uh you can just switch this. And if you run a scout, for example, you will see the difference. So when you go, uh the build is finished, we can just for the uh run a do a scout. Now on the on the one you created now, you should see plenty of vulnerabilities and um you can then also use um the, the image from chain guard. Um and see the differences that you will have nearly no uh vulnerabilities. That's all right. Scout is a plugging, right? Or is it part of the base docker? That's, that's not part, I mean, they released it, I don't know. In which version one of the latest version, they introduced the do a scout possibility, which is similar to other uh tools like sneak um just um scans your image and compares it to some vulnerability databases. And uh yeah, runs it, right? So that runs we can check the app. So it's a regular express server. It's really just a basic um basic example, I getting nervous with the building the image because it takes a little bit of time. So what we did is using and um and it should normally work, but now I'm a little bit um nervous trust, trust the platform. Should I trust the platform? OK. Yeah. Yeah. Yeah. Yeah. Let's give it our best energy while we have a look at the code because we can work on the one of the stretch goals, right? At Jason support for the application. So what do you specifically mean by that? You wanted to send back a Jason format uh response or do you want to receive a Jason? Um Yes, you could now create, for example, a new end point and say, I mean here in this case, I just sent out um the send um it doesn't send you out adjacent, I think there is also the possibility in uh in express that you also can response with a Jason response. So you could develop the stuff or you create a new functionality and normal get. Um Yeah, the line 12, it's something to look up in the in the documentation of express message. And then naturally Jason uh look if they sent Jason or something like this or is it only Jason? I think rest at Jason And then you said the headers, so rest at headers, uh set headers, set header, content type. Yeah. All right. Building danish. Yeah, we focus on this uh application, application slash basic, right? And this should tell the browser that's going to receive a adjacent formatted message. Yeah, I guess it should work. Uh OK. So can you maybe open another, can you open another terminal? Sure and make do a image, for example, definitely let's do that. Uh just the toga image. Oh Her images. Yeah. Just to see if the dog, OK? That working that works fine. And we see also that there is uh OK. This is your image where you um for the the container, right? So you have access to the underlying uh underlying do engine. So it should work. Maybe it's just a little bit slow. Let us uh it says still building the image. Let's check a meanwhile it occurs. And so and this version is called scout is not the man. OK. OK. Then it's uh the version, it's, which is installed on the, the, the, the doesn't contain this. Ok. So what, what could we do now to get this up and running? Um, to not uh blow up our story? So, um, you could now just uh in the second window, you could, um, do a, do a build by hand. So that could be something. So, um, we, when we go back to our Pulumi build, so this is something we need um to check. OK. Then here we have our uh Docker file. Where is it? No. Is it inside the app in the app? Yeah. So um you could go back to the other terminal. Yeah. And uh cancel this one. All right. OK. So this is not working. So uh we can then go into the code of A zero uh 01. Yeah, 01 index. OK. So now you could uh just comment out the line uh 11 to uh 24. So building this, this Yeah. And then the line um 26 you can comment out and then you can run Pulumi up again because we want to have to contain a registry end point. And then you just push um uh by, we use the same uh stack that we created before. Yeah. Yeah. So it should give you now an update. It should say, hey, there is a change. Perfect. So you say yes, what's the change? It's just created the image registry because uh it did not finish the build. So it doesn't appear into the thing. So yeah. So this is now your registry endpoint. Yeah, this is only an API call, right? So it doesn't take that. Yeah, and this is our registry. Er L Yes. So now you can go to uh uh field uh the current field and then minus T for, let's tag it. Yeah. Yeah. What do we want to use for? Um Can you look into the code? What we entered in the initial code uh in the index? Ts, what did we gave it as name? My app was the name. Yes. Right. Yeah. But with the registry string before because you want to push it to the Pulumi Yeah. To the scale we registering. Yeah, this is the step that's uh you have to do it manually every time it's a ring. Got it. So, no, that's perfect. It's really weird that uh that it took this time. It looks like it's the course of the live streams. I don't know why he uh because the engine is working and, but it just takes so much time to download. We are on a remote server. It should not take, maybe it's my network is using my phone. No, you are on the, on the remote server. So it should not. That is true indeed. Yeah, that's uh one of the beauties of using this kind of approach with de but I still struggle to understand why he takes so much time to download the, the base image. So that's really, really weird. No, 20 slim should be slim. What, what kind of a machine did you provisioned on your side? Is it a issue? That's a pro to, I believe it's a pro two. Yeah. So it's not the greatest, but it's not the smallest you one. I was the false one. I, I use a play two micros. Normally. That should be um this one is even bigger. Yeah. Yeah, the other one is even bigger. So I'm wondering why it takes so much time. Uh What is the issue there? Ok. Now, we need to improvise a little bit. That's not a problem. So, um um can you just see that we are reaching a different region here because we are using in Paris one in the first one and then here we are uh Amsterdam. It's a bit further away. OK? Uh For the dog built, it should not be the, I mean, he created to do with it. Yeah. Yeah, he created the dog a registry but here, as you can see, the dog pool takes ages. OK. That's not a problem. Uh Because I have already created um uh a server so we can uh just um switch this. Um You may be wondering why am I so relaxed? Uh We do these kind of live streams uh often here at scale way. Uh And we have these hacking sessions where we expect things to fail. Uh So yeah, I'm kind of used to it. Ok. That it's perfect. Can you try II I just put it into the private chat. Can you just um, oh no. Um where should I put this that you can see this? Um Can you just pull this image down and um just take it then and um good and uh without the HTTP S uh beforehand, so just um without the app. OK. Got it. OK. So other than that, I think the, the engine is screwed. OK? Um OK. Let us uh jump over this chapter. I think that's uh that's uh not, not a big deal because this chapter is not. So um so important because for the deployment, we can just change the, the image to something else. So um if we had to uh 02 and we have to check and afterwards why the death uh take so much time could be related to um let's jump in 202 then deploying the app. So now we switch the language. Yeah. So yeah, go hm This is gibberish to me. OK. That's good. And then um so we're importing a bunch of things. Uh Cool thing that you can import uh from the uh right away. That's cool. And then we have a pull me run right away. And what are we doing here? So now, now we come to the concept of stack references, if you go for the Pulumi, for example, you see that I created here to config I just wanted to have it configurable. So because now in your case, we have to change now the the the the stack reference. So we can see here um the Infra gets collected from the um from my account and scale workshop Infra the APP image reference which is for example, the name of the because we export also the name of the image because we need, this comes from the second stack. So what you need to do now is you go to your um your your command for your your terminal, for example and just go up when you did the Pulumi up for the Infra because we need to just collect um the name or you can go to the Pulumi Cloud application if you want, which is quicker for you. Sure. Let's try the Pulumi then it opened on my laptop monitor. Here is nope, there we go. All right. Got it here. So and then you go to stacks on the left side, you should see now all the sticks. OK? So now we need to get uh the for the first part. So when you click on the scale workshop Infra one infra one. Yeah. Yeah. And and you click on it, then you should see. Yeah, you see now the the stack name and it's inside your organization, it's your user name. So you just need to change now, um the user name in the code uh on the left top, you see the organization. So the the stack references are always built with um when you use the cloud, for example, um organization name in your case, it's uh because it's very small Java script. Yeah, your guitar handle. So you just need to go into the Pulumi Yale and change the DVN, which is my guitar handle or the, the Pulumi organization name to uh javascript. And uh the second one also. And as we keep everything the same, we didn't change anything, it should be working. So this is one part uh we where we get the information because the Infra looks for the cube config when you go into the main go and the image reference would look up the name of your image. So when you open the main dot go again, wait uh this uh completed uh apparently there was an error retrieving credentials. So that could be but darker images, but we have it. So it's here. So uh what could be the the problem? So um you could do a do look out just in case um and we could try again to make the the build. Um OK. So now you could do a um a built again. You have it probably in your the and then uh the name is my app, just give it my app again because we want to um to try again. Sure. Ah you see that's uh huh. Uh, you are in, uh, what does he say? He says in the file. What? Uh sure install it but quietly faith. So end of file. Ok. Could be. This is really strange. Ok. Did not work the work directory from Note 20. What if we change the base image? Um, you could try a, do a pool with the base image name just, you know, just to see if it's uh it's debug er life. So yeah, I was, as I was saying, we do these kind of things every Friday at scale sessions. You are more than welcome to join us. You can find us on youtube and this Friday we will do a live stream uh kind of like this hacking on stream where we will work with the unknown, previously unknown uh programming language uh to try and query some kind of server. Uh Yeah, that's the main, the main idea, things will change and things will fail. So more than welcome to join us. Yeah, that's, that's fine. OK. So um yeah, we do the the the the dog built is now. Yeah, you see now it's, I don't know why. This is really bizarre. OK. Now you can do your um can you try this again in the in the Pulumi program if we go back in again to the index, uh Js activate again everything. So just um so step number two, right? And step number one and then we were here. So do I just run pull up just to uncommon the comment. Yeah, perfect. And then give it a try again and hopefully it should work. Now, I don't know what was wrong. Probably something with the credentials. OK. So he wants to create an image that's fine and the image already exists. So dog credentials connection refused. He always wants to do this dog credential stuff. And then he what's the deal with you in the file? Uh could be related to our um to, to um hm it was a different terminal. The one where I looked out it was different than this one. It be cash. Yep. OK. Um It could be related to the OS environment because you saw that we removed the password login and so on from the image. So what you could try is to also change the spec again to what we had before and just stop sharing your screen and just follow the step in the. Um So no, you know, you can, I have it in an environment variable. I could potentially just pass a reference to environment variable in the it, it, it, it didn't pick it up just as, as it, let's follow the step of the Pulumi sent config and just enter this and um yeah, and now he will ask you about um So OK, so I'm not supposed to pass it here to put my environment my secret here. But in a prompt, right? Beware that we can do this, right? So if I invoke this, so and now you can copy, paste the the the real value of your secret there. Stop sharing for a while. Yeah, just get the the property in just in case that uh this is working. Nope, that wasn't it, this was it. Yeah. Yeah. Do do do. All right. Maybe anyone in the comments has experienced something like this. Do they have any suggestions for this weird issues? I mean, I tried it in the on my machine before that the classical one and it worked but I did not uh I I assume it could be this thing that he expect um the credentials because we use the the stuff. Just try it out. I mean, and then revert the changes in the index t to the beginning and then try again. Pulumi up and hopefully it will work again. So are we back? Yeah. OK. Pulled me up one more time. Perfect. Let's hope that this is fixing it. OK. Yes. OK. This is not fixing it and um we have any OK. Then you can go to your second window and just do a do a push there because we know that it's not working. So you can say, yeah, so it's there. We have that uh image of her images. Oh It's a lot of text. This is it OK, back her push and then uh how do you I don't remember the the name of the image, just the name of the image. Yeah. And then I just need to say no login, right? Yeah, user no log in minus no log in and it should prompt you now for the and uh or just uh without demeanors, you just delete the stuff, it should give you um a prompt or we need to make a do log in before. So OK, then you need to do a do log in with the URL of your registry which is uh mhm. Ok. Yeah, there is one and retrieving the credentials. So it's somehow related with my credentials and my workspace. OK. Then uh let us jump over this. I think that's not as important. Let us not waste the time. We need to check this uh with the uh why it's uh I mean he asked you now for the user name. Can you just type no log in? I don't know why this error message is coming. Weird. And then yeah, this is a key from scale wave. That's again my secret, which I need to retrieve one more time. So I'll be back with my screen in a minute. Perfect. So computers, yeah, it it's, it's always you can try this 10 times and then when you do it. Yeah. And then I need to share my screen one more time. That's why um you can see my head and I'm sharing now and Logan succeeded. Perfect. And now a push should also work perfectly there. Her push uh the whole thing, which is RG. Is it already complete? Nope. Yes. 403. Permission denied. Uh What am I missing? Are you not part of the organization we are working on here? I should be. Yeah, those are micro engines. Uh Let's see. Continue registry and we have their workspace. Yeah. Uh Yeah, that's the name of it. Uh We protect it with RGNL CW cloud. Did we use that name? Yeah. Yeah, one more try. I'm doing doctor push the URL for the name space registry, da da da and then the name of my image and something failed again for the three. OK? No, no problem. Then let's uh let's close this chapter. I mean this is something we have to check that should be not a problem for the next chapter. So let us like look into the 021 how to deploy now with Pulumi uh workload onto Cuba needs, we have the main goal. So the idea is now when we scroll down uh to reference from line 20 the image reference. So um we need just to remove this reference to some hello world image. So if you scroll down, yeah, you should see now uh here the line 50 he will get now the image name from our image reference, but this is something we don't uh uh 51 sorry, 51. So uh we can just delete the app image ref gets string output part. So everything after the image column can be deleted and we hard code now an image name into it. So the idea again, just while you're typing this, um we use the stack reference, we export it in I mean theoretically we exported the the image name which is a generation of the registry name and the image name uh highly dynamic as an export parameter and just use it. So we don't need to think about uh what is the image name? What is uh the version? For example, um Here in this case, we need just to put it by hand into it. So you can the one I sent to you the hello world container from me. Uh The hello server one just enter this one I think um do with Pulumi dot string. So we have to use Pulumi dot String, the method, right? That's the difference between um between the gold version of the SDK of Pulumi and the, the the javascript version or the typescript version. Uh We need now to set this helper function of Pulumi string to to translate a classical string into the uh the Pulumi string object, regular strings and then Pulumi strings. Yeah, that's fine. And we have the version latest the HDP. I don't know why you always put HDP in this. You can delete the first part of the 50 no, the line 51 you're not finished. With this? Oh, you mean this? OK. Yeah, this has to be deleted. Perfect. So we get the hello server and now just uh let me check if the port for 1000 is the right one in this example, uh Can you change the port to um to 80 80 please? Sure. OK, perfect. So if you scroll also down, so now we create the CUBA needs deployment manifest as you can see. So this is the classical, if you would ever saw see the YAML manifest, uh You would see that some of the properties are very equal, but now we have the advantage we can use uh type safe language and yet the target part has also to be changed on a 80. So now we create a service, we say, hey, the service is available on part 80 maps to 80 80. That's completely fine. Um Yeah, that's it. And we create a coate service. You should normally um I think you, you, you worked with um with K its proposal that should be very familiar to the approach with YAML instead you could use now go to deploy. Yeah, it's it's code, even though it's a language that I am not familiar with code, it's code. So I can just spend a bit of time having a look and understanding and, and it gives me a flexibility to think that I can change this in the future and hook it up with something else within my pipeline. Perfect. And yeah, now just head into the 02 folder and give the Pulumi up uh procedure and it, as you see, it's uh similar than before heading into the folder where your stack is defined. Uh we changed in the Pulumi the definition to your stack reference. So we should get the cube config from uh the stack number one. Yes, we had a little bit of issues with the um with the creation of the image. But um yeah, we can just switch this. Yeah. So I'm gonna pull me up now and again to create a new stack and we settled on naming them death, right? Yeah. Again, completely free. You can name it as you wish. It's just not for the, for the example, it's downloading uh a plug-in. Yeah, it's uh Pulumi is uh he's now seeing, hey, I need the Cuba needs provider and he's downloading the binary of the Cubans because the Pulumi in the background. Um when you do a Pulumi app, it starts the language host which is a micro service and it starts the the Cuba needs provider which is a micro service and all the communication happens via GR PC on the machine. So that's uh that's a thing. So um Pulumi architecture is actually uh an engineer colleague also described as a uh a micro service architecture which accidentally runs on your uh machine. So now we come to the situation of go go is very, very not forgiving if you have declared some um some variables and you don't use them. So we can just uh go to line 20 just remove the stuff. We don't need the line 20 to 23. Ok. And give it a go give it a because, yeah, because we don't uh reference now anything from this one. All right. OK. That's perfect. So now uh we've, yeah, perfect. So it needs to create a full. Yeah. Is uh is the provider, create a service and uh do a deployment, right? Yep and perform this update. Yeah. And in theory, you should see now also the stack reference. So you see in line one, he say read Pulumi stack reference and you can see he created the provider also successfully. So that was fine. So we got the cube config and perfect, we got also the load balancer address. So uh scale capsule also provision a lot uh a load balancer. In in theory if you do a curl or um um opening the browser, you should see now our world, the world it's there. So that's really good. So now we can that that was a little bit, we lose a little bit time on the dog part and we definitely need to, to discuss them and to check this uh if it's the death space issue. Um why he comes up with the credential part. But hey, that should not matter now. Um So let's head over to the, to the git ups approach because we all know nobody wants to, to use a cube cut or whatever to just uh push changes. Everybody wants to use a G back end. So in this case, we use also a gi of back end. Yeah. So we have a flux city. Yeah. Did you ever work with flux? I mean, what do you prefer? No, I, I haven't, I haven't. Uh but I, as soon as I heard of it, I've been trying to find an excuse to, to use it. So this is the perfect moment. It's really cool. I mean, yeah, people prefer either one or even both. I mean, there are even a project called Flamingo where you can use a to um to run a flux for example. So it's a sub project and you can combine both using ARGO for the U I elements, for example, but flukes underneath to uh distribute the stuff and you see also an ARGO then the flux components. That's very interesting if you want both. Um I for me, it depends which one I I choose everything has this advantage and disadvantage. So here in this case, I just wanted to show using flux, there is no U I in flux. So it's a little bit more centric on the cube cattle or whatever system you use for observ to know, hey, is everything rolled out or not having an event system connected for giving alerts and so on. So that's the thing. There is a U I from we works. But yeah, it's not a part of the core project. So, all right. So uh we have the prerequisites. Uh we need to clone the hell server. If you want to do any changes, you don't need this. I think we don't have any time to show this. Now um we'll trust the author to have uh done a good job. Yeah. OK. Then we go into a folder and then download the dependencies. So, wow, that was fast. Perfect. Um Now we need to retrieve the output from the cluster deployment. Uh da da da da. So the stack reference and that's defined here, right? And this one uh was the one that was using my github user name. Perfect. I, I think you get the sense out of it. So you see with the third project uh you, you, you get uh slowly, slowly into it. That's good. OK? Now we need to set it up, right? So uh this will read the Pulumi that L file and we set uh this, you did it. No, I mean the Pulumi Con set is when you don't want to do it in the with copy paste, what you did. So actually you already uh you were once that, I mean you IQ 1000 you, you've managed to not use the cli. So that's fine. So that's another or maybe that, that was the other way around. Maybe I should have used the cli in order to update the files manually, but it's fine. It's there. OK? Uh Yeah, so we can skip this because I already it manually. Now we need to deploy the stack. Uh uh This is already done to, to, to, to pull me up, right? You just jump in. Perfect. Let's check it again. Creating new stack, sir. It's gonna be called de and now we wait. So for everybody still following or watching the rerecord again, uh it's here. We're using the micro stick approach. So we separated everything into our own stack. So that's the reason Diego has to create every time uh first a new stack and um we are using then the config references for all stacks, he could even overwrite this. So when he creates the future a prod stake, he could get the stack reference also from the pot uh from the pro uh infrastructure that looks good. And right. So my stack will perform uh in addition of uh the provider flux and gets the hell server er set up. OK. Good. Yeah. And while this is deploying, we can have a look into the code and I give you some of the new mechanisms, some feedback on this one. So let's have a look again. Go, you mentioned according references. Now I kind of know some go and we create a programmatically we create the cub and its provider in 20 putting the cube config in we we received. So this can run completely on AC I system. There needs, doesn't need to be set anything because it retrieves the cube config um we enable server set apply, that's quite handy. Um And now comes the most important part is the deployment of F looks. We see uh we create a new hand release. That's very important because I mentioned this every time. Um it's sometimes very important even if you use a programming language to be not disconnected from the ecosystem. So Pulumi integrates very well with existing things. So we cannot uh I mean, it's clear some things are already out there and we just need to consume them. In this case, the community created a flux helm chart. I don't want to own this. I don't want to write this and go completely fresh from scratch if there is no need. So in this case, I just reuse the one set some values or overwrite some stuff. And here in this case, I did not overwrite anything because we just deployed like this. And here what Pulumi is doing under the hood programmatically and not cli is uh executing the helm helm installed under the, on the code base. So that's quite interesting here. And then we create uh everything gets deployed and then we create the git repository to tell, hey, this is the place to look up the helm chart or to look at the chart definition because we deploy the hello server itself is a helm chart again. So that's the thing, right? OK. And yeah. Get OK. So I don't use, I don't use um a tar file for the helm package to download from a file server. It really clones the git repository and there is a Helm chart inside. So that's also simulating a little bit that maybe in your company, you created a repo with a folder called deploy, right? Let's quickly check it out. Mhm So we have a folder called delivery then inside charts, right? Yeah. And over here chart. All right. So the is telling you what to do. Yeah. So it's like you execute helm install via file system and not via repository. So that's quite interesting. Great. OK. Great, great, great. And then, yeah, we define the Rio and then er handler. What is this part? Yeah. The, yeah, the, the custom resources, I mean, as I said, uh Helm installs some Cr Ds and then we create from this cr Ds, we create a custom resource in this case called Helm release and this is every moving piece, flux need to deploy the stuff. So flux will see. Um There is a Helm a gig repository where to look up the stuff. And then we have uh the helm release where we say to he to to flux. Hey, now release, please. Um The, the hello server one with some properties and this is now uh the the second part. So we can use Pulumi to create uh custom resources from custom resource definitions. And the Coates engine will just um understand this, deploys it. And then um yeah, the flux controller will see them and do some actions on them. So that's uh completely fine cool. As you can see we have some dependencies. So for example, we tell um Pulumi, hey, wait uh when you scroll a little bit down. So 111. Yeah, it depends on. So we say to Pulumi, hey, wait, that the release is done before you uh um apply this resource. So he release has to be created and then he um so in this case, we we we force Pulumi to keep an order because sometimes you just want that this step has to be created beforehand. Pulumi does some ordering in the background but sometimes it makes sense also to set a specific order. So in this case, I really don't wait for this, right? It's really cool. Yeah, the ability to do this is really cool. So new custom resource, we wait for this to to happen beforehand. That's nice, right? And then because otherwise you will deploy it and the he release is not finished and there's missing Cr Ds and you get an error message and so on. So this is the thing, just keep an eye on this and that's one of the reasons this completed successfully. Yeah. And now you can get your cube configured out again and try to see, get pots for example and see if everything is deployed. So yeah, let's go to step three. Right? Oh Over here, read me. So we were here, blew me up and then I can run this. This is just if you want to, to kick off the system a little bit. So you can use the flux cli to, to force flux to do a reconciling before because you can set times. But if sometimes you don't want to wait, maybe in your de system that he waits five minutes before he checks again for a change, then you can force it to reconcile. But um to see if everything is deployed, you can just uh get the config from the before step and um um look at get pots for example that everything is deployed. So keep convict or, or yeah, I don't get it. Um in 00 cluster set up, you just don't want config you remember? Yeah. And you can just reference on this one and say OK, cube cut minus minus Q config and then, and it's in the 00 cluster set up and then do I name it? I click on it. Yeah. Yeah. Yeah. And then get pots, for example, to get all the pots to get dash pots. Uh No, it's a separated, sorry. OK. Now we see they are running and now we can say get services to see the new load balancer entry from our second deployment get services. All right. Yeah. So we see that our hand server hand release has an IP address there. You see. Um Yeah, it's the um 51 159. So the external IP address. So when you run this also in your browser and port 9000, uh yes. Hello from Gopher. OK. That's nice. We have something on our screens that amazing, nice. We deployed now um we are and this is something that we did not um say to um to the API A apply cule apply deployment service. We just uh deployed the the the the GIS operator pointed to a repository and this repository. So when the development team is working now, they just can concentrate maybe on your application stuff where there's a chart in inside, for example, and uh can just work like this and flux will pick up any changes when the kit our changes pool mode, right? Yes. Yes. So no need to, to change any um anything, right? I just need to push and magic will happen. Yeah, I think that's what I like. Perfect. OK. Then the question is now, should we tackle the bonus chapter? Do you want to see the ID P step or should we skip on this one? I mean, um I've already invested. So if you're up for it and if I'm let's do it. OK, so you tell me do. We just jumping into step four. Yes. Uh we can open the the documentation maybe in the browser mode better. Yeah. Yeah, that's much better. Ok. So what are we doing here? Yeah, we're going to use port if you click on the link. So port is uh you probably heard uh everybody uh that uh uh internal developer platforms are a big thing and there are several um providers of this. One of the uh the known one is backstage. I probably everybody heard about backstage and we have also here with port. It's an uh an startup which created uh an approach to say, OK. Um Let us think differently on developed portals. Let us use, for example, a low no code approach to model our relationships between different blueprints between different entities. We want to observe and create them the the service catalog out of it. So you can create them from different data sources. You can push to port and port will then show you everything listed up. You will see this later in a graphic what we built. So the ideas we start with a blueprint define our model. You can use the U I, you can use the um you can use Pulumi for example, to define this and then you take data, different data sources and this data sources will then populate according to the blueprint, the entities with all the properties and you will see at the end a whole relationship. So you can navigate from your company needs platform. You can see which services are running to up who owns the services and which additional services this teams owns. So think about uh the classical approach. Um There's a person who is the owner of the active directory service to read out users. This is a service. Everybody wants to reinvent in a bigger enterprise. Now, I can look up, I can go, for example, in port, I can see is there somebody already created a service like this? I can contact them and then I can reuse their service for example. And this is some things that you have a service discovery, a service catalog of what's all running. And you have also an inventor of your infrastructure. You can see OK, on which infrastructure runs what additionally plot offers also. So so-called actions, you can create a self-service catalog of action. So a developer can come in and say, OK, restart the service, scale the service up without that you need. For example, somebody in your ops team, the ops team can create the uh the the service provided as a self service action to the deaf team and the deaf team can then um execute the stuff on their own. Hm So really something to to check out that I really like this. And here in our last chapter, we just deploy port, we deploy the port uh Cuba needs operator which then maps every workload in the coupon needs cluster to an blueprint. You will see when we watch the, the, when we see it in action and you will see that what is up and running. All right, let's do it. So, so we need a port account, right. I'm hoping I'll be able to just log in with github uh in person demo. No, I don't want a demo. I want to create an account. Uh Sure. Let's sign up with Google. Email me. If you have any questions about, you can see my email there and I'm not going to leak my phone. Yeah, that's not gonna happen. So you don't need your phone. I think you, you just need to enter your organization. So just enter test. Um Yeah, that one and nope just random numbers should be fine also. Hopefully it will not depend on that later on. Do I want to start from scratch? Yeah, stop. We don't use any blueprint because we're going to deploy everything. Ok. So this is now you're empty. The builder is empty. This is the U I where you could create. Now in a no code approach, your blueprints by hand, we do it by code. Now, the self service field on the top is also empty because we don't have any actions currently and the catalog should also be empty because we don't have any uh blueprints and any entities. So that's not right. A a clean state for you to work on. So I'm guessing I will get my credentials that are leaked now. Yeah, you can regenerate them later. Yeah. Uh ok. So I'll need that in a moment. I guess I need to go into the folder and install dependencies. Let's do that. Yeah. Number four bing fast. All right. Now I need to get the class or outputs. So just a step that we did before where I manually updated the uh file this time, let's do it properly. Like following the cli approach. Uh Yeah, a new stock that's gonna be called death and the value is going to be I'm using this as a scratch pad and just, and update it manually and not manually through the Yeah. And if you open now the Pulumi dot dot Ya, you should see that he overwrite now the the default value in. So you see that's what I mentioned, you can set it in the Pulumi Yale for all the sticks and then you can overwrite now some specific conflicts for your stake. So perfect this. Yeah. Yeah. So cool. So cool. All right, we have that. We have the Crenshaw. So let's uh store it as environment variables. Uh So we are working with the client ID. Yeah. Yeah, sure. It's not a demo if you don't leak any credentials. So yeah, and if it doesn't work and you know, can't figure out why. Yeah. So if we were playing a live streaming bingo, we will be doing just fine. All right. Now, do I just run, pull me up. Sure. But on what, what's the code? This is now the biggest part because here everything folds together we're going to use now. Uh plenty of stuff inside here. So the stack references is one thing you should already know capsule ID. Yeah, we have uh we get the idea of the cluster and then uh cloud provider blueprint. So, so we use now a new provider, the one from port and create a blueprint similar to new Cubans cluster. In the scale way part, we now just create a new uh Pulumi resource of type blueprint. OK? Oh You can define the color. Yeah, that's uh something you will see. So this is the the so called blueprints. How entities uh we define what property you see everything is from me. I can design it like I want there is nothing, nothing is given, you know, you just, you just have import string bullion object and this kind of stuff. But how do you feel the stuff? And how do you want to display the stuff is completely up to you? And this is the flexibility of creating a service catalog for your company. The the framework like pot doesn't say to you, hey, you have to use this. They say OK, define your own blueprint show the properties which are important for you, fill the properties which are important for you. There are also some kinds of calculated property you could create, for example, the log in for an HTP site from different properties and put them all together. I mean, the possibilities are really, really huge. But um as you see, um yeah, that's a lot. How about this region over here? You have it as Amsterdam and yet this is something uh for the demo. As you see, I I uh I fill out some of the entities with Pulumi also so that they don't come in dynamically, we should also create this with a dynamic approach port offers also, as I said, different ingestion methods. Uh Here in this case. Yes, of course, we should say uh our cloud provider is now in France. So just change it to your uh region, right? All right. So here we are reaching both Agua and flux. Yeah. So I created a blueprint for an GIT up spec and that could be possible in the future that you say, hey, I have a different cluster which choose ARGO. So it's already also defined. And then uh the definition to filling out will be done dynamically in the back. I just prepared the blueprint and say OK, there are two options in our company. We support ARGO, we support flus and this is something you will see them in port, display it cluster blueprint and then we have uh different versions available. OK? And the name over here, OK. Mhm The cluster, right? So II I randomly? Yeah. Yeah. II I randomly picked out some properties, you know, this that doesn't need to, to reflect any product or real life scenario. I said, OK. What is interesting for me as a user? Maybe I want to see the name of the cluster. I want to see which version it has and maybe is it an how to upgrade cluster or whatever? But you could extend this to all you need uh for yourself. So yeah, and I was noticing that, that we were just using this before on the first step. Yeah. And you get, I get the information out from there. So it's uh an approach to say OK. I use the different stack again to populate my service catalog. That's one source of ingesting. And you see here, for example, the calculation the the cloud portal I get from a combination of the idea of the cluster plus the static part and that's what I meant. You can create um very cool stuff. Yeah. It's, it's really flexible, lets you customize it to your liking. All right. Uh OK. Which are the most interesting parts here. Uh When you scroll down there comes now the important part OK. These are all blueprint definitions. You see they can be uh quite um sophisticated. So if we scroll a little bit down, uh that's again. Um So here you see uh how I release OK. That's the release project. We can we scroll a little bit down. I thought that's the helm release. That's still the blueprint stuff. Yeah, if you scroll further down, ok, now we come again to the Cuban. So you see we have now a Pulumi project with multiple providers. We have one for port and now we create one for Cuban needs again with our cube config and now we deploy the port laps because pot offers also an agent which runs on your uh Kate cluster. Because somehow uh we decided now we want the the data, some of the data, for example, the he releases which are installed, we want them dynamically from the cluster. So we install an agent from port on the coupon needs cluster and tell them, hey agent, this is the way you map the properties from coupon needs to the properties of the blueprint. So you will see this later. That's really clever. And can we use again? Um And now how do we deploy this? We deploy it via flux. So we don't create a whole new release. We learned before we say just say use flux to deploy the stuff. So again, a helm repository uh helm release and here we see other fields. Uh If you scroll down. Um where is it? Where is the here? Now we come to the values field. You see it starts with 365 we set now because it's a chart we set now some of the values and the interesting part starts now with line 376. Yes, of course, client secret and all the stuff. But here with the, the, the the part agent says, OK, if I get a uh company resource from type deployment, what do I do with the values? So I told him if you see a deployment, please create an entity in line 381 and start to map some of the fields of our blueprints. So you see now it's the blueprint we defined on the top. And now we say, hey, use this blueprint and fill out some of the properties you get from your Cubans manifesto dot metadata dot annotations comes from Cuba. And he creates now dynamically depending on the workload of your cluster entities of a specific blueprint. So that's the thing. So here we create the Cubans because now we can dynamically create uh the Cubans cluster. And we can say now the the engine you see we create now um the title it's Flux CD and so on. And um yeah, because this is hard coded. Now I said yeah, it's always flux CD. I mean yeah, we know we don't have ARGO now running here, but we could also generate this dynamically. And you see now the helm release I create I met now the helm release in Latin 392 and I create now a blueprint called hand release. I mean I create now entity from the blueprint. He release dot blueprint and fill out the information from my hand release. So the chart and the chart version and the message if it's successful comes off from the Cuba stuff. So now I have an observable to my flux engine. I could see in port if a he chart failed. I mean, I should see this also in my observ stack, you know, using cockpit cockpit, I think. Yeah, but you see that's the thing, man, that's a big thing. Sorry to, to bombard you now with uh this stuff. But uh I I just want to show you it's really cool. It definitely needs a lot of information, new information most of it. Uh but it's, it's really smart and it's a really pushing towards efficiency, developer efficiency. You don't have to actually do this yourself and you have a platform where you can uh on the one hand automate things. So talking about the flux uh CD part of our conversation, just push your code, that's it. And then over here you have the ability to see what's going on with everything. And I really like the ability to just have a a um spy, installing your in your cluster, getting all this information to uh further uh give you the ability to, to dig into what's going on. Yeah. And I imagine if you create now your, your alert manager, you could create your, you could connect your alert manager and you could show import uh uh an entity of type alert when you defined it. And you could see for every cluster also the alerts import if you want this, you know, just to see some overview. Um because yeah, you can send everything there and then you could create, for example, a self-service action and say, hey, please snooze the alert because I'm working on it. And this is something that developers can do without having access to ops or to, to pay duty or to uh whatever system they could for the system, deactivate some of the properties. I just make up stuff. That's the cool part you can, you can imagine and start to imagine how you can further adapt this to your needs and to your team needs. It's amazing. All right. So what do we do next? Um Could it be just doing? Pull me up? Yes, of course, of course. Is it amazing? And that's it now we just wait. Yeah. So that's nice. Right. Yeah. Nothing fingers crossing that everything is working fine. Will we be this lucky? Hm. Ok. The helm release. This is where the magic is happening. So this should be um where we'd install the port agent. That should be also. Mhm. All right. While that runs, what shall we do next time for our next uh episode, er, sometime in the future? Um I'm completely open for everything. Um Me too. Any ideas from the audience, please let us know through the chat or to reach out to both any or both of us uh any topics that you would like to see me exploring for the first time and see me failing and then learning because of those failures. I'm open to it. Yeah, that's completely fine. Can you open the the the uh can you move the right side of the ID? OK, perfect. We have something. OK. So what does he say? He says uh OK. The name Space Port Kate exporter was not found. OK. That's probably on me. So if we go back to the index Ts, I probably, yeah. And if you scroll a little bit, I mean yeah, the one the main go sorry, my phone just a little bit up just slightly slightly slightly um here. So and a little bit more. OK? We create here and names that. So if you scroll a little bit up, right? Uh No, no, that was too much, too much. I was just trying to find the references. OK? So we want um you see we want to deploy the port release and we say to him, hey, deploy it please in the name space uh port Kate's exporter. So there's a thing and it looks like when we scroll a little bit up that we did not create the port, the the name space for it. So that's uh that's on me. So now he currently tries to, to, to, to create um uh the deployment of the helm release in a name space. He doesn't know. So what we can do now is um let me look at the code also to just give you a quick hint on this one. So um la la, la, la la, he wants to create this. So now you could go into line uh 339 type and enter. Yep. And now we code stuff, we can say um new. Do you get autocomplete when you type in space? Ok. You don't get in. Ok. No problem. I will let you know what is the, the, the code for this. So now you say um V uh V one dot V one V one V one dot Yeah. New name, space, name space. Uh space, upper case, lower case please. This is lower space. All right. Uh brackets. Yeah. And uh not, not the square brackets, the, the curly ones, not the curly ones. The, the brackets. I would say this in English parenthesis. OK. So uh context, CTXCPX comma. Yeah. And now we have to give it a name. We can call it port name space. Uh There's no space. Yeah, that's the idea of uh Pulumi. And then we say comma Yeah. And then we say uh percent uh Right. Uh Da da, da, da, da da. How do I get my A percent? So I'm using a uh split keyboard. Uh that's custom layered and I cannot for where's my A percent? You can copy the one online free for one if you want. OK. So now uh we won B one and then names dot name space arc and the dot dot Connected. So um at the beginning, yeah, on the V one V one V one and then name space Arx, the N is capital and the A is capital only. So Arx name space capital A R, sorry. Capital rxrgs are our arcs. The arguments. OK. Yeah. And then uh you can open again the, the um what is his name? The the parenthesis, parenthesis, sorry. Yeah. Yeah. And now we need to create, you can copy paste the line 3442347. Sure, because it's the same. So now we just need to enter the meta data. OK? And we don't need name space. So free four because we create a name space. We don't need to create a name space. OK? And now you uh in line free free for zero. You just type uh for example, uh a variable name, you can call it N comma error, right? Because that's uh go and then we say um equals yes. And now you can use the, the variable Ns right? And go down to the line here. Yes. And here I just put it there. No, no, no. Um just remove the Pulumi dot String because the output of Pulumi resource is already in um in the right thing. And then you say Ns dot And uh the output fields should be um just a second um should be NS um dot metadata, right dot uh name and parent. OK. And now you can type Pulumi up. So, what we did now is we create a name space beforehand and we pass now the name space in and are sure that um uh can you show me the error message in the browser? I'm piling. So what does he say? He says in 931341 is the first error and expected a column in argument list. Uh Here uh That should be normally fine. Just a second. Um Maybe no. Um did name spa arcs needed a parenthesis or a curly brace. Uh oh It needs like a curly brace, sorry, similar to the Yeah to the one there. So that's got it. No, that's fine. OK, then you can give it again, try it again. So, and now we have this so um you can check now, let me see. Um OK, we don't have, we want to find. So you can go to uh the, the 02 deploy app example, go there to the main goal and um there is we want and you can yes, you can um copy paste. Um the, the import of this, of the uh So you mean which part this land? It's, it's called um uh you see in, in, in line seven, if you scroll up, just copy line seven, the core will be one and put it also up there. OK? And now a copy paste core one the variable name because we just have to change either you change it to V one there or you go downstairs and change it uh downstairs. I say um in the code and then just change V one to core V one. And also yeah, perfect. And I'll try again. Let's see. Uh Yeah, that looks much better. That looks much better. OK? So I have to change this part that maybe you make a pull request and enter definition here. So uh undefined N S3 41 can you go to uh equals in free? You have to enter a column so free free for one before the equals sign, you have to put a column, sign colon. OK. Yes. So sure just uh like and then uh no space between and yeah, like this. OK? Give it a go cool almost there. OK? And now uh the meta core one, you have also to copy paste from the other example because this is also missing. Um So the meta V one you can copy and we replace this to me V one. Yes, it's a little bit um without any sense. Yeah, so it's fine. Yeah, it's already there. Hm We could it without intelligence. Yeah, intelligence is very important. OK? That looks fine. So now we see he creates a name space and he should then also deploy the release because now the name space is there. Yeah. So back when I first started working with the web, we didn't have any intelligence for javascript Go. Yeah. It was many years before it landed and became popular. OK. Here um in the main goal you need now to add the provider also, I forgot about this. So because we created the Cuba needs provider, programmatically, we need to set it into the name. So when you go to name space, um the definition of the name space resource 3 40 something you see on free, free, free seven, you see Pulumi dot provider provider, just copy this part. I mean the whole part, the Pulumi dot provider. Yeah, perfect and just enter it in 345 because we have to say now to not use the default end point uh which is normally set through your coup config or something or your environmental variable. Um because he tries to create it now um on a different Cuba cluster on your local host or something. So here in this case, that was the error message. So now he created the name space. Perfect. Who? That was a thing? So that's perfect. So what you can do now is you can go now to port, right? If I go to port and yeah, you see. So it's already up and running. You see the he releases which are deployed. Perfect is the error message helm installed succeeded. You see that's all that's coming now from your cluster, if you go to um the Cuba needs one on the left side, on the left bar, you click on, click on Cuba, you see this is your Cuba needs cluster up and running. Currently, you see the amount of notes you see flux CD is installed. And now you can see on the bottom the related entities you see uh the get up flux is running. You see the cloud provider. Yeah, perfect. Um Those three notes. Yeah, portal gives me access to my console directly. The URL. Yeah. Yeah, that's the calculation we did. So you can jump into here. You see this is something you can add, you can enter your your cockpit dashboard. For example, if you want, if you installed cockpit and you see now on the right side, the helm releases also on this Cuba needs cluster in the bottom and the related entities you see helm releases, helm and these are the helm releases which are installed on this cluster in the revision and this data comes all from the needs cluster cluster directly. Cool. That's awesome. And this is the the agent, right? Yeah, that's the agent who does know all the heavy lifting for us. So when you click on the builder in the the navigation bar on the top you build up, this is for example, now the the entity we created um when you click on the cross sign there with the arrows, you can open it and you can see all the properties we create, as I said, I mean, that's the way you could now change stuff. We don't do this uh via um um what's the name? The uh the, the low code, no code approach to create additional entities and so on. That's, it's easier, it's more traceable, you know, it's easier to see. Yeah, that's on the bottom left. You see you can open all of them in one. So when you click on the bottom left, one expand all. Yeah. So you see now. There we go. All right. That's awesome. So it is. Hm, they created in under two hours, under two hours. So that's a, that's a thing. It was quite challenging. So yeah, that's the situation. Yeah. In your catalog, you see now all the informations you have your clusters. The whole story is through. We created now via simple commands. We created a cluster, we deployed uh F looks on it, we deployed application on top of it and then used um to register everything to have a easy service catalog and discovery. Oh Mate, I will take some time to have a look at this because it's so beautiful and encourages me to keep learning and, and changing things and breaking things and coming back. Yeah. That's, that's awesome. Yeah. It's an amazing journey. Thank you. Thank you so much for coming along with me and helping me navigate this first deep dive into Cuban. Uh I believe I learned a lot. I hope the audience learned through our mistakes. Well, my mistakes, to be honest, I don't know. What was it? It's the stuff. I think it's uh I have to check this again. Why the um the engine did not behave like we expected it, but we will continue to learn based on that. But yeah, it's been real fun. Hey, thank you for having me during this er, couple of hours of episodes. Yeah, thanks that you came and, uh, looking forward to do an additional, uh, workshop and yeah, let us know via linkedin or Twitter or youtube comments, um, what you're looking forward and. Yeah, thanks. Yeah, please let us know, uh I'm guessing in the uh final step of rolling everything back and tearing down, we'll be done afterwards. Yeah, it's maybe boring for you folks. So, yeah, I'll make sure to do this by myself and, er, regenerating my credentials that were leaked. Ok. Then, then I'll stop shooting and there we are. Yeah. And then, um, I say, yeah, have a nice.

---
