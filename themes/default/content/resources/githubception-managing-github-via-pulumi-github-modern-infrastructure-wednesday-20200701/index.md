---
preview_image:
hero:
  image: /icons/containers.svg
  title: "GitHub-ception: Managing GitHub via Pulumi with GitHub | Modern Infrastructure Wednesday 2020-07-01"
title: "GitHub-ception: Managing GitHub via Pulumi with GitHub |..."
meta_desc: |
    In today's episode, we use Pulumi to manage GitHub itself. But we don't stop there! We use GitHub Actions to execute the Pulumi program, so we're u...
url_slug: githubception-managing-github-via-pulumi-github-modern-infrastructure-wednesday-20200701
featured: false
pre_recorded: true
pulumi_tv: false
unlisted: false
gated: false
type: webinars
external: false
no_getting_started: true
block_external_search_index: false
main:
  title: "GitHub-ception: Managing GitHub via Pulumi with GitHub | Modern Infrastructure Wednesday 2020-07-01"
  description: |
    In today's episode, we use Pulumi to manage GitHub itself. But we don't stop there! We use GitHub Actions to execute the Pulumi program, so we're using GitHub to manage GitHub via Pulumi. Code for this episode is available here: https://github.com/pulumi/pulumitv/tree/master/modern-infrastructure-wednesday/2020-07-01  The examples are in C# but Pulumi makes it easy to stand up infrastructure in your favorite languages including TypeScript, JavaScript, Go, and Python - saving time over legacy tools like CloudFormation and Hashicorp Terraform.  https://www.pulumi.com/docs/get-started/?utm_campaign=PulumiTV&utm_source=youtube.com&utm_medium=video
  sortable_date: 2020-07-01T18:16:45Z
  youtube_url: https://www.youtube.com/embed/9du5S9_1kM0
transcript: |
    Hello and welcome to another episode of Modern Infrastructure Wednesday. I'm your host, Lee Zen. Today we'll be doing github section. What does that mean managing github from github means exactly what it says. It means it means we're going to manage github using Pulumi from github. So we're going to be using the github actions and, and C I integration with Pulumi to modify github. Uh as we're using github, it's truly github section. So let's just get started. I think hopefully it'll be a little bit clearer what I mean as we go along. So we have this open terminal window. Uh what I really wanted to show was just kind of what the, the file structure looks like. Um So if we go down here, uh I'm in my github section directory. Um And uh if I look in here, um I have this project called github section. So even within my own folder structure, it is a little bit uh inception where I have github section within G up section, uh get section. And uh if I look at the, if I look at the I have a github uh directory, and if I look at the github. Um You'll see, I have some workflows and uh these workflows are more or less uh what's listed in the Pulumi github actions uh documentation. So if you, if you look at uh under a continuous delivery, Pulumi Kiu Actions on the Pulumi website, you'll find uh kind of how to set up github actions uh to run your Pulumi programs as part of a uh uh continuous delivery uh set up. So uh you can basically run Pulumi previews and UPS uh And then also just create workflow files and there's some example templates in here. And so I've basically set those up um in um in our little uh in our little repo here. And so you can see we just, you know, we have this workflow running and uh you know, it pulls the repo and it runs, it runs our program. So that's great. And well, how are we going to achieve github section? Well, the way we're gonna do that is we're going to manage that github repo uh using plume, but that's gonna get executed using github. So let's, let's try that. Uh So we're going to use the uh uh uh get hub uh me, I believe it's called Pulumi Get Up. So we're gonna actually use this particular provider. Um So you can see it's called the Pulumi Gib. I'm using, I'm using C# today. Uh Pulumi offers multiple languages gonna be using C# today. And so we're going to use the uh github provider. All right. And uh let's do that. And if I could look at um my stack right now, I have nothing in here and we're gonna do something super simple. First. Let's just, let's, you know, boo me, we have hundreds of rebo uh I think something like over 100 rebo uh in, in, in, in Polian. So it would be nice to be able to manage all of our uh issues uh with uh with the pro program, which we can do actually. So uh our issue labels. And so uh let's create a, uh we're gonna create a pull request to see all of this happen in action. So let's switch branches um called issue labels. And so um we can see kind of how that might work. We, we would probably want to get all the repositories uh for this particular organization. So we can look at how this, this particular thing works. Um So we would do something along these lines. So I'm gonna copy this. I don't actually need this to be an app. Let's just start with this. Um So we call this repos and I don't need this to be an app, but I'm going to iterate through all the repos um and up so I need to use OK. And uh we're gonna use this and just like that. So that's a very basic query and then, you know, just to make sure this works, we can just iterate through the, uh, various re bows and this should be the, uh, result. So, and we want the names so we can go through each name and we can just like for now, let's just, let's just, uh, use Pulumi log and we'll just, uh, we'll just do this little bug thing here. So this just wanna show you kind of how, uh, oops show you how the, uh, provider might work. So let's make sure I'm the right directory and I already have this configured with my uh github token. So the provider has the github token uh configured. So we should be able to execute and call this uh function and uh it should spit out a huge list of repositories. So let's see if that works and you can see here we have all these different uh repositories that, that get listed. So now let's actually do something against those repositories. Uh So as I mentioned, I was mentioning like one convenient thing you could totally imagine doing is going ahead and creating a um and it like we want to manage a common set of issues across all the repos. So let's do that. Let's like create an issue that's gonna issue label, keep saying issue, issue label, it's create an issue label that exists in every single repository and like that would be great because then we don't have to manage different labels in different repos uh separately. So how can we do that. Well, if we go back here, uh there's an issue label, uh resource. So what is gonna be one of these? And we got our handy Danny auto completion here. So we'll, we'll um you know, call this something like example label and we'll give it a new uh issue yards and this takes um a color description, name and repository. So the repository is going to obviously be uh the revote and um the color, let's make it uh Pulumi purple. So let's look at the, the uh Pulumi uh dot com slash brand, I think. Yes, let's get this. Uh I don't have it memorized unfortunately yet. Uh I, I will eventually. So let's get this color in here. Um And then I think we need um a name and so we'll call it like gloomy TV. All right. So let's say, you know, let's say we want this bloomy TV label in every single one of our rep repos. So let's, let's do this so we could run the preview here. Um And let's see what happens. So this should go ahead and create all these different resources for us. Uh If, if we were to run up, obviously, I'm running a preview and you can see it's proposing to create all these different issue labels. Um And we can actually let's go, go ahead and try to create the pull request. Yeah. Oops, I don't have this on the screen. So if we go ahead and open this pr we should get a uh action that will then, um, and now I don't have it set up to include the action here. But if we, uh if we go look at here, we have this action that automatically runs to give us the preview. Um And, and actually, uh after this runs, we should get a comment on our pr from the uh Pulumi bot. So gonna wait for that to run and uh through the magic of TV, we'll be right back and we're back. So, uh this, this uh run completed. And uh if we look at the actual preview, run, um you know, we, we did everything we said we would do, we uh we, you know, got the action, we checked out the repo and then we ran the action and uh it built and then it, it proposed creating all the labels for every single uh repository as we expected. So that's great. Um Let's not do that though because I don't actually want to truly touch every single repo. So let's add a little bit of a change in here. Let's let's add in um git section, which is the repo I'm on right now. So this should only propose a change for GIT section. So let's do that. It's only uh apply labels to deception and let's just push that. Uh we don't even have to do the preview. And uh that should just like do the preview and we would expect that to, to not change too much. Um So in uh in normal circumstances, we would wait for this pull request to uh for that action to complete again. Um And you can see actually here, it's, it's in progress, but I'm going to uh go ahead and just skip this um for the purposes of, of, of our demo. Uh since we already knew that the, the previous one passed. Um uh And now this, you know, I can, I can actually do the preview locally just to double check um in case we're really paranoid and this, this filter should obviously only pick up that one rebo for us. So, uh instead of doing all the re bows, we'll have this one rebo and we can see that's true here. So we're only gonna do this 11 label and uh because uh let's just, let's just push that. So let's merge this pull request. And if we look at the history, we will have had a, you know, we've merged in these, these changes, apply a label only to get deception. And now we're gonna run the push. Uh This is the push action right here. And uh you know, each time pulling that container, it's a fairly decently sized image. So it takes like, you know, on the order of roughly a minute. Um So, uh I'm gonna pause here and again through the magic of TV, show you the result in just a moment. All right, and we're back so you can see this, this merge pull request completed. So let's take a look at what happened in our update. We ran this pull in the action and we actually just ran the up. And so we uh we went ahead and created that actual uh label. And so if we go to our issues, we should under labels. See a handy dandy Pulumi TV. What do you know? So that's awesome. So, uh just to recap what happened? This is pretty cool. If you think about it, we used github to manage github via Pulumi. And so now every time we go ahead and uh manage and edit our Pulumi program and we, we go ahead and create a pull request. We'll see a preview for what we would change about github um via github. And uh and then every time we merge that pull request, we will end up changing some part of our github configuration uh through uh github. So it's kind of nice, nice little github section here we're doing. And uh yeah, that's really what I wanted to show you. Just kind of how cool it is to be able to uh put together a few things put together Pulumi actions along with the github provider to be able to control github through github via Pulumi. That's a mouthful, which is why I called it G section. And if you like this episode, please subscribe to Pulumi TV. Uh, please like this video and we'll be doing lots more fun, modern infrastructure Wednesday every week on Wednesdays. Make sure you hit the, uh, the notification button too to get notified of when new episodes come out for Pulumi TV. Again, I'm your host, Lee Zen. Please follow me on Twitter. You can follow Pulumi Corp as well and I'll post all the code to the Pulumi TV. Uh examples repo, uh which is listed here on the uh on the, on the out slide here. So if you go to Pulumi TV dot com, uh youtube dot com slash Pulumi TV, uh you'll also be able to get links to uh all the various repos as well. So, yeah, hope you enjoy today's episode. Thanks for watching and we'll see you next week.
---
