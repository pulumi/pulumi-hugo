{{/* Fetch the current version of the Pulumi CLI doc." suffix. */}}
{{ $headers := dict }}
{{ $gitHubToken := os.Getenv "GITHUB_TOKEN" }}
{{ if ne $gitHubToken "" }}
    {{ $token := printf "Bearer %s" $gitHubToken }}
    {{ $headers = (dict "Authorization" $token) }}
{{ end }}

{{- $json := getJSON "https://api.github.com/repos/pulumi/docs/contents/content/docs/reference/cli/pulumi.md" $headers }}
{{ with $json }}
    {{ $content := base64Decode .content }}
    {{/* Remove front matter and "Auto generated by..." suffix. */}}
    {{- $content = replaceRE "(?s)---.*---" "" $content -}}
    {{- $content = replaceRE "(?m)^###### Auto generated by .*$" "" $content -}}
    {{- markdownify $content -}}
{{ end }}
